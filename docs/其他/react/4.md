---
id: 4
title: 4.çŠ¶æ€state
sidebar_position: 4
---
# é˜¶æ®µ4:çŠ¶æ€State

## ğŸ¯ å­¦ä¹ ç›®æ ‡
ç†è§£State(çŠ¶æ€)çš„æ¦‚å¿µ,å­¦ä¼šä½¿ç”¨useStateé’©å­,è®©ç»„ä»¶å…·å¤‡"è®°å¿†"å’Œ"å˜åŒ–"çš„èƒ½åŠ›ã€‚

---

## ä¸€ã€ä»€ä¹ˆæ˜¯State?

### Props vs State:æœ‰ä»€ä¹ˆåŒºåˆ«?

| å¯¹æ¯”é¡¹ | Props | State |
|--------|-------|-------|
| **æ¯”å–»** | çˆ¶æ¯ç»™çš„é›¶èŠ±é’±(è¢«åŠ¨æ¥æ”¶) | è‡ªå·±çš„å­˜é’±ç½(ä¸»åŠ¨ç®¡ç†) |
| **æ¥æº** | ä»çˆ¶ç»„ä»¶ä¼ å…¥ | ç»„ä»¶è‡ªå·±å†…éƒ¨å®šä¹‰ |
| **èƒ½å¦ä¿®æ”¹** | âŒ åªè¯»,ä¸èƒ½æ”¹ | âœ… å¯ä»¥ç”¨setStateæ”¹ |
| **ç”¨é€”** | æ¥æ”¶å¤–éƒ¨æ•°æ® | ç®¡ç†ç»„ä»¶å†…éƒ¨æ•°æ® |

**é€šä¿—è§£é‡Š**:
- **Props**: åˆ«äººå‘Šè¯‰ä½ çš„ä¿¡æ¯(ä½ å®¶åœ°å€ã€ä½ çš„åå­—)
- **State**: ä½ è‡ªå·±çš„çŠ¶æ€(ä½ é¥¿ä¸é¥¿ã€ä½ ç´¯ä¸ç´¯)

```javascript
// Props:ä»å¤–éƒ¨æ¥æ”¶,ä¸èƒ½æ”¹
<Counter start={0} />  // startæ˜¯Props,Counterç»„ä»¶ä¸èƒ½æ”¹å®ƒ

// State:ç»„ä»¶è‡ªå·±çš„æ•°æ®,å¯ä»¥æ”¹
function Counter() {
  const [count, setCount] = useState(0);  // countæ˜¯State,å¯ä»¥ç”¨setCountä¿®æ”¹
}
```

---

## äºŒã€useState:ç»™ç»„ä»¶æ·»åŠ "è®°å¿†"

### åŸºæœ¬è¯­æ³•

```javascript
import { useState } from 'react';  // å…ˆå¯¼å…¥

function MyComponent() {
  // è¯­æ³•:const [çŠ¶æ€å˜é‡, ä¿®æ”¹å‡½æ•°] = useState(åˆå§‹å€¼);
  const [count, setCount] = useState(0);
  
  // count:å½“å‰å€¼
  // setCount:ä¿®æ”¹countçš„å‡½æ•°
  // 0:åˆå§‹å€¼
}
```

**ç±»æ¯”**: å°±åƒå®šä¹‰ä¸€ä¸ª"æœ‰è®°å¿†"çš„å˜é‡
```javascript
// æ™®é€šå˜é‡:ç»„ä»¶é‡æ–°æ¸²æŸ“åå€¼ä¼šä¸¢å¤±
let count = 0;

// Stateå˜é‡:Reactä¼šå¸®ä½ è®°ä½,é‡æ–°æ¸²æŸ“åå€¼è¿˜åœ¨
const [count, setCount] = useState(0);
```

---

## ä¸‰ã€å®æˆ˜æ¡ˆä¾‹1:è®¡æ•°å™¨

### ç›®æ ‡:ç‚¹å‡»æŒ‰é’®,æ•°å­—+1

åˆ›å»º `src/Counter.js`:

```javascript
import { useState } from 'react';  // ç¬¬1æ­¥:å¯¼å…¥useState

function Counter() {
  // ç¬¬2æ­¥:å®šä¹‰State
  const [count, setCount] = useState(0);  // åˆå§‹å€¼æ˜¯0
  
  // ç¬¬3æ­¥:å®šä¹‰ä¿®æ”¹Stateçš„å‡½æ•°
  const handleAdd = () => {
    setCount(count + 1);  // è°ƒç”¨setCountä¿®æ”¹count
    // âš ï¸ åƒä¸‡ä¸è¦å†™ count = count + 1,è¿™æ ·ä¸ä¼šè§¦å‘é¡µé¢æ›´æ–°!
  };
  
  return (
    <div style={{ padding: '20px', textAlign: 'center' }}>
      {/* æ˜¾ç¤ºå½“å‰count */}
      <h1 style={{ fontSize: '48px', color: '#333' }}>
        {count}
      </h1>
      
      {/* ç‚¹å‡»æŒ‰é’®è°ƒç”¨handleAdd */}
      <button 
        onClick={handleAdd}
        style={{
          padding: '10px 20px',
          fontSize: '18px',
          backgroundColor: '#4CAF50',
          color: 'white',
          border: 'none',
          borderRadius: '5px',
          cursor: 'pointer'
        }}
      >
        +1
      </button>
    </div>
  );
}

export default Counter;
```

**ä½¿ç”¨** - åœ¨ `App.js`:
```javascript
import Counter from './Counter';

function App() {
  return <Counter />;
}

export default App;
```

**è¿è¡Œç»“æœ**:
- åˆå§‹æ˜¾ç¤ºæ•°å­— 0
- æ¯æ¬¡ç‚¹å‡»æŒ‰é’®,æ•°å­—åŠ 1
- é¡µé¢è‡ªåŠ¨æ›´æ–°(è¿™å°±æ˜¯Stateçš„é­”æ³•!)

---

### ä¸ºä»€ä¹ˆç”¨State,ä¸ç”¨æ™®é€šå˜é‡?

```javascript
// âŒ é”™è¯¯ç¤ºèŒƒ:ç”¨æ™®é€šå˜é‡
function BrokenCounter() {
  let count = 0;  // æ™®é€šå˜é‡
  
  const handleAdd = () => {
    count = count + 1;
    console.log(count);  // æ§åˆ¶å°èƒ½çœ‹åˆ°countå˜äº†
  };
  
  return <h1>{count}</h1>;  // ä½†é¡µé¢ä¸ä¼šæ›´æ–°!
}

// âœ… æ­£ç¡®:ç”¨State
function Counter() {
  const [count, setCount] = useState(0);  // State
  
  const handleAdd = () => {
    setCount(count + 1);  // è°ƒç”¨setCountä¼šè§¦å‘é¡µé¢é‡æ–°æ¸²æŸ“
  };
  
  return <h1>{count}</h1>;  // é¡µé¢ä¼šæ›´æ–°!
}
```

**å…³é”®**: åªæœ‰ç”¨ `setState` ä¿®æ”¹State,Reactæ‰çŸ¥é“"å“¦,æ•°æ®å˜äº†,æˆ‘è¦æ›´æ–°é¡µé¢"ã€‚

---

## å››ã€å®æˆ˜æ¡ˆä¾‹2:å¼€å…³æŒ‰é’®

### ç›®æ ‡:ç‚¹å‡»æŒ‰é’®åˆ‡æ¢å¼€/å…³çŠ¶æ€

åˆ›å»º `src/ToggleButton.js`:

```javascript
import { useState } from 'react';

function ToggleButton() {
  // Stateå¯ä»¥æ˜¯ä»»ä½•ç±»å‹:æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€å¯¹è±¡ã€æ•°ç»„...
  const [isOn, setIsOn] = useState(false);  // åˆå§‹æ˜¯false(å…³)
  
  const handleToggle = () => {
    setIsOn(!isOn);  // å–å:trueå˜false,falseå˜true
  };
  
  return (
    <div style={{ padding: '20px', textAlign: 'center' }}>
      {/* æ ¹æ®isOnæ˜¾ç¤ºä¸åŒå†…å®¹ */}
      <h2>ç¯å…‰çŠ¶æ€: {isOn ? 'ğŸ’¡ å¼€å¯' : 'ğŸŒ™ å…³é—­'}</h2>
      
      <button 
        onClick={handleToggle}
        style={{
          padding: '15px 30px',
          fontSize: '18px',
          backgroundColor: isOn ? '#f44336' : '#4CAF50',  // å¼€å¯æ—¶çº¢è‰²,å…³é—­æ—¶ç»¿è‰²
          color: 'white',
          border: 'none',
          borderRadius: '5px',
          cursor: 'pointer'
        }}
      >
        {isOn ? 'å…³é—­' : 'å¼€å¯'}
      </button>
    </div>
  );
}

export default ToggleButton;
```

**è¿è¡Œç»“æœ**:
- åˆå§‹æ˜¾ç¤º"ç¯å…‰çŠ¶æ€: ğŸŒ™ å…³é—­",æŒ‰é’®æ˜¯ç»¿è‰²
- ç‚¹å‡»æŒ‰é’®åå˜æˆ"ç¯å…‰çŠ¶æ€: ğŸ’¡ å¼€å¯",æŒ‰é’®å˜çº¢è‰²
- å†ç‚¹å‡»åˆåˆ‡æ¢å›å»

---

## äº”ã€å®æˆ˜æ¡ˆä¾‹3:è¾“å…¥æ¡†å®æ—¶æ˜¾ç¤º

### ç›®æ ‡:è¾“å…¥æ¡†è¾“å…¥ä»€ä¹ˆ,ä¸‹é¢å°±æ˜¾ç¤ºä»€ä¹ˆ

åˆ›å»º `src/InputDemo.js`:

```javascript
import { useState } from 'react';

function InputDemo() {
  const [text, setText] = useState('');  // åˆå§‹æ˜¯ç©ºå­—ç¬¦ä¸²
  
  // å½“è¾“å…¥æ¡†å†…å®¹å˜åŒ–æ—¶è§¦å‘
  const handleChange = (event) => {
    const newText = event.target.value;  // è·å–è¾“å…¥æ¡†çš„å€¼
    setText(newText);  // æ›´æ–°State
  };
  
  return (
    <div style={{ padding: '20px' }}>
      <h3>å®æ—¶æ˜¾ç¤ºè¾“å…¥å†…å®¹:</h3>
      
      {/* è¾“å…¥æ¡† */}
      <input 
        type="text"
        value={text}  // âš ï¸ é‡è¦:æŠŠStateç»‘å®šåˆ°value
        onChange={handleChange}  // ç›‘å¬å˜åŒ–
        placeholder="è¯·è¾“å…¥å†…å®¹..."
        style={{
          padding: '10px',
          fontSize: '16px',
          width: '300px',
          border: '2px solid #ddd',
          borderRadius: '5px'
        }}
      />
      
      {/* å®æ—¶æ˜¾ç¤º */}
      <p style={{ marginTop: '20px', fontSize: '18px', color: '#333' }}>
        ä½ è¾“å…¥çš„æ˜¯: <strong>{text}</strong>
      </p>
      
      {/* æ˜¾ç¤ºå­—æ•° */}
      <p style={{ color: '#666' }}>
        å­—æ•°: {text.length}
      </p>
    </div>
  );
}

export default InputDemo;
```

**è¿è¡Œç»“æœ**:
- åœ¨è¾“å…¥æ¡†è¾“å…¥"Hello",ä¸‹é¢ç«‹å³æ˜¾ç¤º"ä½ è¾“å…¥çš„æ˜¯: Hello"
- å­—æ•°ä¹Ÿå®æ—¶æ›´æ–°

**å…³é”®ç‚¹**:
- `value={text}`: å—æ§ç»„ä»¶,è¾“å…¥æ¡†çš„å€¼ç”±Stateæ§åˆ¶
- `onChange={handleChange}`: æ¯æ¬¡è¾“å…¥éƒ½è§¦å‘,æ›´æ–°State
- Stateå˜åŒ– â†’ é¡µé¢è‡ªåŠ¨æ›´æ–°

---

## å…­ã€Stateæ›´æ–°çš„è¿›é˜¶æŠ€å·§

### æŠ€å·§1:åŸºäºæ—§å€¼æ›´æ–°State

```javascript
function Counter() {
  const [count, setCount] = useState(0);
  
  // âŒ æ–¹å¼1:ç›´æ¥ç”¨count(å¯èƒ½æœ‰é—®é¢˜)
  const add1 = () => {
    setCount(count + 1);
  };
  
  // âœ… æ–¹å¼2:ç”¨å‡½æ•°(æ¨è,æ›´å®‰å…¨)
  const add2 = () => {
    setCount(prevCount => prevCount + 1);
    // prevCountæ˜¯æ›´æ–°å‰çš„å€¼,Reactä¿è¯å®ƒæ˜¯æœ€æ–°çš„
  };
  
  // å¦‚æœè¿ç»­è°ƒç”¨,æ–¹å¼2æ›´å‡†ç¡®
  const add3Times = () => {
    setCount(prev => prev + 1);  // +1
    setCount(prev => prev + 1);  // å†+1
    setCount(prev => prev + 1);  // å†+1
    // æœ€ç»ˆ+3
  };
}
```

### æŠ€å·§2:å¤šä¸ªStateå˜é‡

```javascript
function UserForm() {
  // å¯ä»¥å®šä¹‰å¤šä¸ªState
  const [name, setName] = useState('');
  const [age, setAge] = useState(18);
  const [email, setEmail] = useState('');
  
  return (
    <div>
      <input value={name} onChange={e => setName(e.target.value)} />
      <input value={age} onChange={e => setAge(Number(e.target.value))} />
      <input value={email} onChange={e => setEmail(e.target.value)} />
    </div>
  );
}
```

### æŠ€å·§3:Stateæ˜¯å¯¹è±¡æ—¶

```javascript
function Profile() {
  const [user, setUser] = useState({
    name: 'å°æ˜',
    age: 18,
    city: 'åŒ—äº¬'
  });
  
  // âŒ é”™è¯¯:ç›´æ¥æ”¹å¯¹è±¡(ä¸ä¼šè§¦å‘æ›´æ–°)
  const wrongUpdate = () => {
    user.age = 19;  // ä¸è¦è¿™æ ·!
  };
  
  // âœ… æ­£ç¡®:åˆ›å»ºæ–°å¯¹è±¡
  const correctUpdate = () => {
    setUser({
      ...user,  // å¤åˆ¶æ—§å€¼
      age: 19   // åªæ”¹age
    });
  };
}
```

---

## ä¸ƒã€ç»¼åˆæ¡ˆä¾‹:äº¤äº’å¼ä¸ªäººèµ„æ–™å¡

### ç›®æ ‡:å¯ä»¥ç¼–è¾‘å§“åå’Œç®€ä»‹çš„å¡ç‰‡

åˆ›å»º `src/EditableCard.js`:

```javascript
import { useState } from 'react';

function EditableCard() {
  // å®šä¹‰ä¸¤ä¸ªState
  const [name, setName] = useState('å¼ ä¸‰');
  const [bio, setBio] = useState('è¿™æ˜¯ä¸€æ®µç®€ä»‹');
  const [isEditing, setIsEditing] = useState(false);  // æ˜¯å¦åœ¨ç¼–è¾‘æ¨¡å¼
  
  return (
    <div style={{
      border: '2px solid #4CAF50',
      borderRadius: '10px',
      padding: '20px',
      maxWidth: '400px',
      margin: '20px auto'
    }}>
      <h2>ä¸ªäººèµ„æ–™</h2>
      
      {isEditing ? (
        // ç¼–è¾‘æ¨¡å¼:æ˜¾ç¤ºè¾“å…¥æ¡†
        <div>
          <div style={{ marginBottom: '10px' }}>
            <label>å§“å:</label>
            <input 
              value={name}
              onChange={e => setName(e.target.value)}
              style={{ marginLeft: '10px', padding: '5px' }}
            />
          </div>
          
          <div style={{ marginBottom: '10px' }}>
            <label>ç®€ä»‹:</label>
            <textarea 
              value={bio}
              onChange={e => setBio(e.target.value)}
              style={{ 
                marginLeft: '10px', 
                padding: '5px',
                width: '250px',
                height: '60px'
              }}
            />
          </div>
          
          <button 
            onClick={() => setIsEditing(false)}
            style={{
              padding: '8px 16px',
              backgroundColor: '#4CAF50',
              color: 'white',
              border: 'none',
              borderRadius: '5px',
              cursor: 'pointer'
            }}
          >
            ä¿å­˜
          </button>
        </div>
      ) : (
        // æŸ¥çœ‹æ¨¡å¼:æ˜¾ç¤ºå†…å®¹
        <div>
          <h3>{name}</h3>
          <p style={{ color: '#666' }}>{bio}</p>
          
          <button 
            onClick={() => setIsEditing(true)}
            style={{
              padding: '8px 16px',
              backgroundColor: '#2196F3',
              color: 'white',
              border: 'none',
              borderRadius: '5px',
              cursor: 'pointer'
            }}
          >
            ç¼–è¾‘
          </button>
        </div>
      )}
    </div>
  );
}

export default EditableCard;
```

**è¿è¡Œç»“æœ**:
1. åˆå§‹æ˜¾ç¤º"å¼ ä¸‰"å’Œç®€ä»‹,æœ‰"ç¼–è¾‘"æŒ‰é’®
2. ç‚¹"ç¼–è¾‘" â†’ å‡ºç°è¾“å…¥æ¡†,å¯ä¿®æ”¹
3. æ”¹å®Œç‚¹"ä¿å­˜" â†’ æ˜¾ç¤ºæ–°å†…å®¹

**æ¶‰åŠçŸ¥è¯†ç‚¹**:
- 3ä¸ªStateå˜é‡
- æ¡ä»¶æ¸²æŸ“(æ ¹æ®isEditingæ˜¾ç¤ºä¸åŒUI)
- è¡¨å•å—æ§ç»„ä»¶

---

## âœ… é˜¶æ®µ4æ€»ç»“

**ä½ å·²ç»å­¦ä¼š**:
1. âœ“ Stateçš„æ¦‚å¿µ(ç»„ä»¶çš„"è®°å¿†")
2. âœ“ useStateçš„è¯­æ³•:`const [value, setValue] = useState(åˆå§‹å€¼)`
3. âœ“ ä¿®æ”¹Stateä¼šè§¦å‘é¡µé¢é‡æ–°æ¸²æŸ“
4. âœ“ å—æ§ç»„ä»¶(è¾“å…¥æ¡†çš„å€¼ç”±Stateæ§åˆ¶)
5. âœ“ å¤šä¸ªStateçš„ç®¡ç†

**æ ¸å¿ƒå…¬å¼**:
```
Stateå˜åŒ– â†’ Reacté‡æ–°æ¸²æŸ“ç»„ä»¶ â†’ é¡µé¢è‡ªåŠ¨æ›´æ–°
```

**éªŒæ”¶æ ‡å‡†**:
- èƒ½ç”¨useStateåˆ›å»ºStateå˜é‡
- èƒ½é€šè¿‡setStateä¿®æ”¹State
- ç†è§£ä¸ºä»€ä¹ˆæ”¹Stateè¦ç”¨setState,ä¸èƒ½ç›´æ¥èµ‹å€¼

**Props vs State å¯¹æ¯”è¡¨**:

| | Props | State |
|---|---|---|
| èƒ½å¦ä¿®æ”¹ | âŒ åªè¯» | âœ… å¯æ”¹ |
| è°æ‹¥æœ‰ | çˆ¶ç»„ä»¶ | å½“å‰ç»„ä»¶ |
| æ”¹å˜æ—¶ | çˆ¶ç»„ä»¶ä¼ æ–°å€¼ | è°ƒç”¨setState |
| ç”¨é€” | æ¥æ”¶å¤–éƒ¨æ•°æ® | ç®¡ç†å†…éƒ¨çŠ¶æ€ |

**ä¸‹ä¸€æ­¥**:
ç°åœ¨ç»„ä»¶èƒ½"è®°ä½"æ•°æ®äº†,ä½†è¿˜ä¸èƒ½å“åº”å¤æ‚çš„ç”¨æˆ·æ“ä½œã€‚ä¸‹ä¸€é˜¶æ®µæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ **äº‹ä»¶å¤„ç†**,åŒ…æ‹¬ç‚¹å‡»ã€è¾“å…¥ã€æäº¤ç­‰å¸¸è§äº¤äº’!

---

## ğŸ’¡ ç»ƒä¹ é¢˜

åšä¸€ä¸ª `ColorPicker` ç»„ä»¶:
- æœ‰3ä¸ªæŒ‰é’®:çº¢ã€ç»¿ã€è“
- ç‚¹å‡»æŒ‰é’®,ä¸‹æ–¹çš„æ–¹å—å˜æˆå¯¹åº”é¢œè‰²
- æç¤º:ç”¨Stateå­˜å‚¨å½“å‰é¢œè‰²

```javascript
// å‚è€ƒç»“æ„
function ColorPicker() {
  const [color, setColor] = useState('gray');
  
  return (
    <div>
      <button onClick={() => setColor('red')}>çº¢è‰²</button>
      {/* å…¶ä»–æŒ‰é’®... */}
      <div style={{ 
        width: '100px', 
        height: '100px', 
        backgroundColor: color 
      }}></div>
    </div>
  );
}
```