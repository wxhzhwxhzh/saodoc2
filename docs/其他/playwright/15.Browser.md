---
id: intro15
title: 'ğŸ’œ15.Browser'
---


# Playwright for Pythonï¼šBrowser ç±»ä¸­æ–‡ç‰ˆæ–‡æ¡£
Browser ç±»å¯¹åº”æµè§ˆå™¨å®ä¾‹ï¼ˆå¦‚ Chromiumã€Firefoxã€WebKitï¼‰ï¼Œç”¨äºç®¡ç†æµè§ˆå™¨ç”Ÿå‘½å‘¨æœŸã€åˆ›å»ºæµè§ˆå™¨ä¸Šä¸‹æ–‡ï¼ˆBrowserContextï¼‰ï¼Œæ˜¯ Playwright æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„é¡¶å±‚å…¥å£ä¹‹ä¸€ã€‚ä¸€ä¸ª Browser å®ä¾‹å¯åŒ…å«å¤šä¸ªç‹¬ç«‹çš„ BrowserContextï¼Œå®ç°å¤šç¯å¢ƒéš”ç¦»è¿è¡Œã€‚

## å¿«é€Ÿç¤ºä¾‹
### åŒæ­¥ç¤ºä¾‹
```python
from playwright.sync_api import sync_playwright, Playwright

def run(playwright: Playwright):
    # å¯åŠ¨ Chromium æµè§ˆå™¨ï¼ˆé»˜è®¤æ— å¤´æ¨¡å¼ï¼‰
    browser = playwright.chromium.launch(headless=False)
    # åˆ›å»ºæµè§ˆå™¨ä¸Šä¸‹æ–‡
    context = browser.new_context()
    # åˆ›å»ºé¡µé¢
    page = context.new_page()
    page.goto("https://example.com")
    print("é¡µé¢æ ‡é¢˜ï¼š", page.title())
    
    # å…³é—­èµ„æº
    page.close()
    context.close()
    browser.close()

with sync_playwright() as playwright:
    run(playwright)
```

### å¼‚æ­¥ç¤ºä¾‹
```python
import asyncio
from playwright.async_api import async_playwright, Playwright

async def run(playwright: Playwright):
    # å¯åŠ¨ Firefox æµè§ˆå™¨
    browser = await playwright.firefox.launch()
    # åˆ›å»ºä¸Šä¸‹æ–‡å¹¶é…ç½®è§†å£
    context = await browser.new_context(viewport={"width": 1280, "height": 720})
    # æ‰“å¼€æ–°é¡µé¢
    page = await context.new_page()
    await page.goto("https://example.com")
    print("é¡µé¢ URLï¼š", page.url)
    
    # å…³é—­èµ„æº
    await page.close()
    await context.close()
    await browser.close()

async def main():
    async with async_playwright() as playwright:
        await run(playwright)

asyncio.run(main())
```

## æ ¸å¿ƒæ–¹æ³•
### browser_type
è·å–å½“å‰æµè§ˆå™¨å®ä¾‹å¯¹åº”çš„æµè§ˆå™¨ç±»å‹ï¼ˆChromium/Firefox/WebKitï¼‰ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
browser_type = browser.browser_type
print(browser_type.name)  # è¾“å‡º "chromium" / "firefox" / "webkit"

# å¼‚æ­¥
browser_type = browser.browser_type
print(browser_type.name)
```

#### è¿”å›å€¼
`BrowserType` å®ä¾‹ï¼ŒåŒ…å«æµè§ˆå™¨åç§°ã€å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ç­‰ä¿¡æ¯ã€‚

### close
å…³é—­æµè§ˆå™¨å®ä¾‹ï¼ŒåŒæ—¶å…³é—­æ‰€æœ‰å…³è”çš„ BrowserContext å’Œ Pageã€‚

#### ç”¨æ³•
```python
browser.close()  # åŒæ­¥
await browser.close()  # å¼‚æ­¥
```

#### è¯´æ˜
- å…³é—­åæµè§ˆå™¨å®ä¾‹ä¸å¯å†ä½¿ç”¨ï¼Œæœªæ‰‹åŠ¨å…³é—­çš„ä¸Šä¸‹æ–‡å’Œé¡µé¢ä¼šè¢«è‡ªåŠ¨æ¸…ç†
- å»ºè®®åœ¨è‡ªåŠ¨åŒ–æµç¨‹ç»“æŸæ—¶æ˜¾å¼è°ƒç”¨ï¼Œé¿å…èµ„æºæ³„éœ²

### context
ï¼ˆv1.41+ æ–°å¢ï¼‰è·å–æµè§ˆå™¨çš„é»˜è®¤ä¸Šä¸‹æ–‡ï¼ˆè‹¥æœªæ‰‹åŠ¨åˆ›å»ºä¸Šä¸‹æ–‡ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤ä¸Šä¸‹æ–‡ï¼‰ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
default_context = browser.context
page = default_context.new_page()  # ä½¿ç”¨é»˜è®¤ä¸Šä¸‹æ–‡åˆ›å»ºé¡µé¢

# å¼‚æ­¥
default_context = browser.context
page = await default_context.new_page()
```

#### è¿”å›å€¼
`BrowserContext` å®ä¾‹ï¼ˆé»˜è®¤ä¸Šä¸‹æ–‡ï¼‰ã€‚

### is_closed
æ£€æŸ¥æµè§ˆå™¨å®ä¾‹æ˜¯å¦å·²å…³é—­ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
is_closed = browser.is_closed
print(f"æµè§ˆå™¨æ˜¯å¦å·²å…³é—­ï¼š{is_closed}")

# å¼‚æ­¥
is_closed = browser.is_closed
print(f"æµè§ˆå™¨æ˜¯å¦å·²å…³é—­ï¼š{is_closed}")
```

#### è¿”å›å€¼
å¸ƒå°”å€¼ï¼ˆ`True` è¡¨ç¤ºå·²å…³é—­ï¼Œ`False` è¡¨ç¤ºæœªå…³é—­ï¼‰ã€‚

### new_browser_cdp_session
åˆ›å»ºæµè§ˆå™¨çº§åˆ«çš„ Chrome DevTools Protocol (CDP) ä¼šè¯ï¼Œç”¨äºé«˜çº§æµè§ˆå™¨æ§åˆ¶ï¼ˆä»…æ”¯æŒ Chromium å†…æ ¸ï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
cdp_session = browser.new_browser_cdp_session()
# é€šè¿‡ CDP å¯ç”¨æ€§èƒ½ç›‘æ§
cdp_session.send("Performance.enable")
# è·å–æ€§èƒ½æŒ‡æ ‡
metrics = cdp_session.send("Performance.getMetrics")
print(metrics)
cdp_session.detach()

# å¼‚æ­¥
cdp_session = await browser.new_browser_cdp_session()
await cdp_session.send("Performance.enable")
metrics = await cdp_session.send("Performance.getMetrics")
print(metrics)
await cdp_session.detach()
```

#### è¯´æ˜
- ä»…é€‚ç”¨äº Chromium æµè§ˆå™¨ï¼ŒFirefox/WebKit ä¸æ”¯æŒ CDP åè®®
- ç”¨äºæ‰§è¡Œ Playwright é«˜å±‚ API æœªè¦†ç›–çš„åº•å±‚æ“ä½œ

### new_context
åˆ›å»ºæ–°çš„æµè§ˆå™¨ä¸Šä¸‹æ–‡ï¼ˆBrowserContextï¼‰ï¼Œä¸Šä¸‹æ–‡ä¹‹é—´ç›¸äº’éš”ç¦»ï¼ˆCookieã€æœ¬åœ°å­˜å‚¨ã€ç¼“å­˜ç­‰äº’ä¸å…±äº«ï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šåŸºç¡€ç”¨æ³•
context1 = browser.new_context()

# åŒæ­¥ï¼šå¸¦é…ç½®çš„ä¸Šä¸‹æ–‡ï¼ˆè§†å£ã€ç”¨æˆ·ä»£ç†ã€Cookieï¼‰
context2 = browser.new_context(
    viewport={"width": 1920, "height": 1080},
    user_agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
    cookies=[{"name": "token", "value": "123456", "domain": "example.com", "path": "/"}],
    locale="zh-CN",  # è¯­è¨€ç¯å¢ƒ
    geolocation={"latitude": 39.9042, "longitude": 116.4074}  # åœ°ç†ä½ç½®
)

# å¼‚æ­¥
context = await browser.new_context(viewport={"width": 1280, "height": 720})
```

#### å‚æ•°è¯´æ˜ï¼ˆæ ¸å¿ƒå‚æ•°ï¼‰
| å‚æ•° | ç”¨é€” | ç±»å‹ |
|------|------|------|
| `viewport` | é¡µé¢é»˜è®¤è§†å£å¤§å° | Dictï¼ˆwidth/heightï¼‰ |
| `user_agent` | è‡ªå®šä¹‰ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸² | str |
| `cookies` | åˆå§‹åŒ– Cookie åˆ—è¡¨ | List[Dict] |
| `locale` | è¯­è¨€ç¯å¢ƒï¼ˆå¦‚ "zh-CN"ã€"en-US"ï¼‰ | str |
| `geolocation` | åœ°ç†ä½ç½®ä¿¡æ¯ | Dictï¼ˆlatitude/longitudeï¼‰ |
| `permissions` | æˆäºˆçš„æƒé™ï¼ˆå¦‚ "geolocation"ã€"notifications"ï¼‰ | List[str] |
| `headless` | æ˜¯å¦ä»¥æ— å¤´æ¨¡å¼è¿è¡Œä¸Šä¸‹æ–‡ | bool |
| `device_scale_factor` | è®¾å¤‡åƒç´ æ¯”ï¼ˆå¦‚ 2 å¯¹åº”é«˜æ¸…å±ï¼‰ | int |

#### è¿”å›å€¼
`BrowserContext` å®ä¾‹ã€‚

### new_page
ç›´æ¥åˆ›å»ºæ–°é¡µé¢ï¼ˆå†…éƒ¨ä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤æµè§ˆå™¨ä¸Šä¸‹æ–‡ï¼Œè‹¥æœªå­˜åœ¨ï¼‰ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
page = browser.new_page()
page.goto("https://example.com")

# å¼‚æ­¥
page = await browser.new_page()
await page.goto("https://example.com")
```

#### è¯´æ˜
- ä¾¿æ·ç”¨æ³•ï¼Œé€‚ç”¨äºç®€å•åœºæ™¯ï¼ˆæ— éœ€å¤šä¸Šä¸‹æ–‡éš”ç¦»ï¼‰
- è‹¥éœ€è‡ªå®šä¹‰ä¸Šä¸‹æ–‡é…ç½®ï¼Œå»ºè®®å…ˆè°ƒç”¨ `new_context()` å†åˆ›å»ºé¡µé¢

### start_tracing
å¯åŠ¨æµè§ˆå™¨æ€§èƒ½è¿½è¸ªï¼Œç”¨äºè®°å½•é¡µé¢åŠ è½½ã€è„šæœ¬æ‰§è¡Œç­‰æ€§èƒ½æ•°æ®ï¼ˆä»…æ”¯æŒ Chromiumï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
# å¯åŠ¨è¿½è¸ªï¼Œä¿å­˜åˆ°æ–‡ä»¶
browser.start_tracing(path="trace.json", screenshots=True, categories=["devtools.timeline"])
# æ‰§è¡Œéœ€è¦è¿½è¸ªçš„æ“ä½œ
page = browser.new_page()
page.goto("https://example.com")
# åœæ­¢è¿½è¸ª
browser.stop_tracing()

# å¼‚æ­¥
await browser.start_tracing(path="trace.json", screenshots=True)
page = await browser.new_page()
await page.goto("https://example.com")
await browser.stop_tracing()
```

#### å‚æ•°è¯´æ˜
- `path`ï¼šè¿½è¸ªæ•°æ®ä¿å­˜è·¯å¾„ï¼ˆ.json æ ¼å¼ï¼‰
- `screenshots`ï¼šæ˜¯å¦æ•è·è¿½è¸ªè¿‡ç¨‹ä¸­çš„æˆªå›¾ï¼ˆé»˜è®¤ Falseï¼‰
- `categories`ï¼šæŒ‡å®šè¿½è¸ªçš„æ€§èƒ½ç±»åˆ«ï¼ˆé»˜è®¤ä½¿ç”¨é¢„è®¾æ ¸å¿ƒç±»åˆ«ï¼‰
- `snapshots`ï¼šæ˜¯å¦æ•è· DOM å¿«ç…§ï¼ˆé»˜è®¤ Falseï¼Œv1.33+ï¼‰

### stop_tracing
åœæ­¢æµè§ˆå™¨æ€§èƒ½è¿½è¸ªï¼Œè‹¥å¯åŠ¨æ—¶æŒ‡å®šäº† `path`ï¼Œä¼šè‡ªåŠ¨å°†è¿½è¸ªæ•°æ®å†™å…¥æ–‡ä»¶ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
browser.stop_tracing()
# è‹¥æœªæŒ‡å®š pathï¼Œå¯è·å–è¿½è¸ªæ•°æ®
trace_data = browser.stop_tracing()

# å¼‚æ­¥
await browser.stop_tracing()
trace_data = await browser.stop_tracing()
```

#### è¿”å›å€¼
è‹¥å¯åŠ¨è¿½è¸ªæ—¶æœªæŒ‡å®š `path`ï¼Œè¿”å›è¿½è¸ªæ•°æ®ï¼ˆäºŒè¿›åˆ¶æ ¼å¼ï¼‰ï¼›å¦åˆ™è¿”å› `None`ã€‚

### version
è·å–æµè§ˆå™¨çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
version = browser.version
print(f"æµè§ˆå™¨ç‰ˆæœ¬ï¼š{version}")  # ç¤ºä¾‹è¾“å‡ºï¼š"Chromium 120.0.6099.109"

# å¼‚æ­¥
version = browser.version
print(f"æµè§ˆå™¨ç‰ˆæœ¬ï¼š{version}")
```

#### è¿”å›å€¼
å­—ç¬¦ä¸²ç±»å‹ï¼ŒåŒ…å«æµè§ˆå™¨åç§°å’Œå…·ä½“ç‰ˆæœ¬å·ã€‚

## æ ¸å¿ƒå±æ€§
| å±æ€§ | ç”¨é€” | è¿”å›ç±»å‹ | é€‚ç”¨ç‰ˆæœ¬ |
|------|------|----------|----------|
| `browser_type` | è·å–æµè§ˆå™¨ç±»å‹ï¼ˆChromium/Firefox/WebKitï¼‰ | BrowserType | æ‰€æœ‰ç‰ˆæœ¬ |
| `context` | è·å–é»˜è®¤æµè§ˆå™¨ä¸Šä¸‹æ–‡ | BrowserContext | v1.41+ |
| `is_closed` | æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦å·²å…³é—­ | bool | æ‰€æœ‰ç‰ˆæœ¬ |
| `version` | è·å–æµè§ˆå™¨ç‰ˆæœ¬ä¿¡æ¯ | str | æ‰€æœ‰ç‰ˆæœ¬ |

## å¸¸ç”¨äº‹ä»¶
| äº‹ä»¶ | è§¦å‘æ—¶æœº | äº‹ä»¶æ•°æ® | è¯´æ˜ |
|------|----------|----------|------|
| `disconnected` | æµè§ˆå™¨å®ä¾‹æ–­å¼€è¿æ¥æ—¶ï¼ˆå¦‚å´©æºƒã€æ‰‹åŠ¨å…³é—­ï¼‰ | æ—  | æ–­å¼€åæµè§ˆå™¨ä¸å¯å†ä½¿ç”¨ |
| `page` | æµè§ˆå™¨ä¸­åˆ›å»ºæ–°é¡µé¢æ—¶ | Page | åŒ…æ‹¬é€šè¿‡ `new_page()` æˆ–é¡µé¢å†…è·³è½¬æ‰“å¼€çš„æ–°é¡µé¢ |
| `targetchanged` | æµè§ˆå™¨ç›®æ ‡ï¼ˆé¡µé¢/ä¸Šä¸‹æ–‡ï¼‰å‘ç”Ÿå˜åŒ–æ—¶ | Target | ä»…æ”¯æŒ Chromium å†…æ ¸ |
| `targetcreated` | æµè§ˆå™¨åˆ›å»ºæ–°ç›®æ ‡æ—¶ | Target | ä»…æ”¯æŒ Chromium å†…æ ¸ |
| `targetdestroyed` | æµè§ˆå™¨é”€æ¯ç›®æ ‡æ—¶ | Target | ä»…æ”¯æŒ Chromium å†…æ ¸ |

## é‡è¦è¯´æ˜
1.  **æµè§ˆå™¨å¯åŠ¨æ¨¡å¼**ï¼š`launch()` é»˜è®¤ä»¥æ— å¤´æ¨¡å¼å¯åŠ¨ï¼Œè®¾ç½® `headless=False` å¯æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼ˆä¾¿äºè°ƒè¯•ï¼‰ã€‚
2.  **èµ„æºéš”ç¦»**ï¼šä¸åŒ `BrowserContext` ä¹‹é—´çš„ Cookieã€LocalStorageã€ä¼šè¯ä¿¡æ¯å®Œå…¨éš”ç¦»ï¼Œé€‚åˆå¤šè´¦å·å¹¶è¡Œæµ‹è¯•ã€‚
3.  **æµè§ˆå™¨å…¼å®¹æ€§**ï¼š
    - Chromiumï¼šæ”¯æŒ CDP åè®®ã€æ€§èƒ½è¿½è¸ªç­‰é«˜çº§åŠŸèƒ½
    - Firefox/WebKitï¼šéƒ¨åˆ†åº•å±‚ APIï¼ˆå¦‚ `new_browser_cdp_session`ï¼‰ä¸æ”¯æŒ
4.  **èµ„æºé‡Šæ”¾**ï¼šå»ºè®®é€šè¿‡ `with` è¯­å¥ï¼ˆåŒæ­¥ï¼‰/ `async with` è¯­å¥ï¼ˆå¼‚æ­¥ï¼‰ç®¡ç† Playwright å®ä¾‹ï¼Œè‡ªåŠ¨é‡Šæ”¾èµ„æºï¼Œé¿å…æ‰‹åŠ¨å…³é—­é—æ¼ã€‚

---
