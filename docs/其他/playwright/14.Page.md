---
id: intro14
title: 'ğŸ’œ14.Page'
---

# Playwright for Pythonï¼šPage ç±»ä¸­æ–‡ç‰ˆæ–‡æ¡£
Page ç±»ç”¨äºä¸æµè§ˆå™¨ä¸­çš„å•ä¸ªæ ‡ç­¾é¡µæˆ– Chromium ä¸­çš„æ‰©å±•åå°é¡µé¢äº¤äº’ï¼Œä¸€ä¸ª Browser å®ä¾‹å¯åŒ…å«å¤šä¸ª Page å®ä¾‹ã€‚

## å¿«é€Ÿç¤ºä¾‹
### åŸºç¡€ç”¨æ³•ï¼ˆåŒæ­¥/å¼‚æ­¥ï¼‰
#### åŒæ­¥ç¤ºä¾‹
```python
from playwright.sync_api import sync_playwright, Playwright

def run(playwright: Playwright):
    webkit = playwright.webkit
    browser = webkit.launch()
    context = browser.new_context()
    page = context.new_page()
    page.goto("https://example.com")
    page.screenshot(path="screenshot.png")
    browser.close()

with sync_playwright() as playwright:
    run(playwright)
```

#### å¼‚æ­¥ç¤ºä¾‹
```python
import asyncio
from playwright.async_api import async_playwright, Playwright

async def run(playwright: Playwright):
    webkit = playwright.webkit
    browser = await webkit.launch()
    context = await browser.new_context()
    page = await context.new_page()
    await page.goto("https://example.com")
    await page.screenshot(path="screenshot.png")
    await browser.close()

async def main():
    async with async_playwright() as playwright:
        await run(playwright)

asyncio.run(main())
```

### äº‹ä»¶å¤„ç†
#### ç›‘å¬å•æ¬¡äº‹ä»¶
```python
page.once("load", lambda: print("é¡µé¢åŠ è½½å®Œæˆï¼"))
```

#### è®¢é˜…ä¸å–æ¶ˆè®¢é˜…äº‹ä»¶
```python
def log_request(intercepted_request):
    print("å‘èµ·è¯·æ±‚ï¼š", intercepted_request.url)

page.on("request", log_request)
# åç»­å–æ¶ˆç›‘å¬
page.remove_listener("request", log_request)
```

## æ ¸å¿ƒæ–¹æ³•
### add_init_script
åœ¨é¡µé¢å¯¼èˆªæˆ–å­æ¡†æ¶é™„åŠ /å¯¼èˆªæ—¶æ³¨å…¥è„šæœ¬ï¼Œè„šæœ¬åœ¨æ–‡æ¡£åˆ›å»ºåã€è‡ªèº«è„šæœ¬è¿è¡Œå‰æ‰§è¡Œï¼Œé€‚ç”¨äºä¿®æ”¹ JavaScript ç¯å¢ƒã€‚

#### ç”¨æ³•ç¤ºä¾‹
1. åˆ›å»º preload.js æ–‡ä»¶ï¼š
```javascript
Math.random = () => 42;
```
2. æ³¨å…¥è„šæœ¬ï¼š
```python
# åŒæ­¥
page.add_init_script(path="./preload.js")
# å¼‚æ­¥
await page.add_init_script(path="./preload.js")
```

#### å‚æ•°è¯´æ˜
- `path`ï¼šJavaScript æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„åŸºäºå½“å‰å·¥ä½œç›®å½•ï¼‰
- `script`ï¼šç›´æ¥æ³¨å…¥çš„è„šæœ¬å­—ç¬¦ä¸²

### add_locator_handler
æ£€æµ‹åˆ°æŒ‡å®šæµ®å±‚ï¼ˆå¦‚æ³¨å†Œå¼¹çª—ï¼‰æ—¶è‡ªåŠ¨æ‰§è¡Œå¤„ç†å‡½æ•°ï¼Œç§»é™¤é®æŒ¡å…ƒç´ ä»¥ä¿è¯æµ‹è¯•æµç¨‹ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šå…³é—­æ–°é—»è®¢é˜…å¼¹çª—
def handler():
    page.get_by_role("button", name="ä¸äº†ï¼Œè°¢è°¢").click()

page.add_locator_handler(page.get_by_text("è®¢é˜…æ–°é—»é€šè®¯"), handler)
page.goto("https://example.com")
page.get_by_role("button", name="å¼€å§‹ä½¿ç”¨").click()

# å¼‚æ­¥
async def handler():
    await page.get_by_role("button", name="ä¸äº†ï¼Œè°¢è°¢").click()

await page.add_locator_handler(page.get_by_text("è®¢é˜…æ–°é—»é€šè®¯"), handler)
await page.goto("https://example.com")
await page.get_by_role("button", name="å¼€å§‹ä½¿ç”¨").click()
```

#### å‚æ•°è¯´æ˜
- `locator`ï¼šè§¦å‘å¤„ç†å‡½æ•°çš„å®šä½å™¨
- `handler`ï¼šå¤„ç†æµ®å±‚çš„å‡½æ•°
- `no_wait_after`ï¼šæ˜¯å¦ä¸ç­‰å¾…æµ®å±‚éšè—ï¼ˆé»˜è®¤ç­‰å¾…ï¼‰
- `times`ï¼šå¤„ç†å‡½æ•°æœ€å¤§æ‰§è¡Œæ¬¡æ•°ï¼ˆé»˜è®¤æ— é™åˆ¶ï¼‰

### add_script_tag
å‘é¡µé¢æ·»åŠ  `<script>` æ ‡ç­¾ï¼Œæ”¯æŒé€šè¿‡ URLã€æ–‡ä»¶è·¯å¾„æˆ–ç›´æ¥å†…å®¹æ³¨å…¥ã€‚

#### å‚æ•°è¯´æ˜
- `content`ï¼šåŸå§‹ JavaScript å†…å®¹
- `path`ï¼šJavaScript æ–‡ä»¶è·¯å¾„
- `type`ï¼šè„šæœ¬ç±»å‹ï¼ˆå¦‚ 'module' ç”¨äº ES6 æ¨¡å—ï¼‰
- `url`ï¼šè„šæœ¬ URL

#### è¿”å›å€¼
ElementHandleï¼ˆæ·»åŠ çš„è„šæœ¬æ ‡ç­¾å…ƒç´ ï¼‰

### add_style_tag
å‘é¡µé¢æ·»åŠ æ ·å¼ï¼Œæ”¯æŒé€šè¿‡ URLã€æ–‡ä»¶è·¯å¾„æˆ–ç›´æ¥ CSS å†…å®¹ã€‚

#### å‚æ•°è¯´æ˜
- `content`ï¼šåŸå§‹ CSS å†…å®¹
- `path`ï¼šCSS æ–‡ä»¶è·¯å¾„
- `url`ï¼šæ ·å¼æ–‡ä»¶ URL

#### è¿”å›å€¼
ElementHandleï¼ˆæ·»åŠ çš„æ ·å¼æ ‡ç­¾å…ƒç´ ï¼‰

### bring_to_front
æ¿€æ´»å½“å‰æ ‡ç­¾é¡µï¼Œå°†é¡µé¢ç½®äºå‰å°ã€‚

#### ç”¨æ³•
```python
page.bring_to_front()  # åŒæ­¥
await page.bring_to_front()  # å¼‚æ­¥
```

### close
å…³é—­é¡µé¢ï¼Œå¯é€‰æ‹©æ˜¯å¦æ‰§è¡Œ `beforeunload` å¤„ç†å™¨ã€‚

#### å‚æ•°è¯´æ˜
- `reason`ï¼šé¡µé¢å…³é—­çš„åŸå› æè¿°ï¼ˆv1.40+ï¼‰
- `run_before_unload`ï¼šæ˜¯å¦æ‰§è¡Œå¸è½½å¤„ç†å™¨ï¼ˆé»˜è®¤ Falseï¼‰

### content
è·å–é¡µé¢å®Œæ•´ HTML å†…å®¹ï¼ˆåŒ…å«æ–‡æ¡£ç±»å‹å£°æ˜ï¼‰ã€‚

#### ç”¨æ³•
```python
html = page.content()  # åŒæ­¥
html = await page.content()  # å¼‚æ­¥
```

### drag_and_drop
å°†æºå…ƒç´ æ‹–åŠ¨åˆ°ç›®æ ‡å…ƒç´ ï¼Œæ”¯æŒæŒ‡å®šæ‹–æ‹½èµ·å§‹å’Œç»“æŸä½ç½®ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
page.drag_and_drop("#æºå…ƒç´ ", "#ç›®æ ‡å…ƒç´ ")
# æŒ‡å®šä½ç½®æ‹–æ‹½
page.drag_and_drop(
    "#æºå…ƒç´ ", "#ç›®æ ‡å…ƒç´ ",
    source_position={"x": 34, "y": 7},
    target_position={"x": 10, "y": 20}
)

# å¼‚æ­¥
await page.drag_and_drop("#æºå…ƒç´ ", "#ç›®æ ‡å…ƒç´ ")
```

### emulate_media
æ¨¡æ‹Ÿ CSS åª’ä½“ç±»å‹æˆ–åª’ä½“ç‰¹æ€§ï¼ˆå¦‚æ·±è‰²æ¨¡å¼ï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# æ¨¡æ‹Ÿæ‰“å°æ¨¡å¼
page.emulate_media(media="print")  # åŒæ­¥
await page.emulate_media(media="print")  # å¼‚æ­¥

# æ¨¡æ‹Ÿæ·±è‰²æ¨¡å¼
page.emulate_media(color_scheme="dark")  # åŒæ­¥
await page.emulate_media(color_scheme="dark")  # å¼‚æ­¥
```

### evaluate
åœ¨æµè§ˆå™¨ä¸Šä¸‹æ–‡æ‰§è¡Œ JavaScript è¡¨è¾¾å¼ï¼Œè¿”å›æ‰§è¡Œç»“æœã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
result = page.evaluate("([x, y]) => x * y", [7, 8])  # è¾“å‡º 56
print(page.evaluate("1 + 2"))  # è¾“å‡º 3

# å¼‚æ­¥
result = await page.evaluate("([x, y]) => x * y", [7, 8])
```

### get_by_* å®šä½æ–¹æ³•
ä¸€ç³»åˆ—åŸºäºè¯­ä¹‰çš„å®šä½æ–¹æ³•ï¼Œç®€åŒ–å…ƒç´ æŸ¥æ‰¾ï¼š

| æ–¹æ³• | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| get_by_alt_text | é€šè¿‡æ›¿ä»£æ–‡æœ¬å®šä½ï¼ˆå¦‚å›¾ç‰‡ï¼‰ | page.get_by_alt_text("Playwright å›¾æ ‡").click() |
| get_by_label | é€šè¿‡æ ‡ç­¾æ–‡æœ¬å®šä½è¾“å…¥æ¡† | page.get_by_label("ç”¨æˆ·å").fill("john") |
| get_by_placeholder | é€šè¿‡å ä½æ–‡æœ¬å®šä½è¾“å…¥æ¡† | page.get_by_placeholder("name@example.com").fill("test@xxx.com") |
| get_by_role | é€šè¿‡ ARIA è§’è‰²å®šä½ | page.get_by_role("button", name="æäº¤").click() |
| get_by_test_id | é€šè¿‡æµ‹è¯• ID å®šä½ | page.get_by_test_id("directions").click() |
| get_by_text | é€šè¿‡æ–‡æœ¬å†…å®¹å®šä½ | page.get_by_text("Hello world").click() |
| get_by_title | é€šè¿‡ title å±æ€§å®šä½ | page.get_by_title("é—®é¢˜æ•°é‡").text_content() |

### goto
å¯¼èˆªåˆ°æŒ‡å®š URLï¼Œè¿”å›ä¸»èµ„æºå“åº”ã€‚

#### ç”¨æ³•
```python
page.goto("https://example.com")  # åŒæ­¥
await page.goto("https://example.com")  # å¼‚æ­¥
```

#### å‚æ•°è¯´æ˜
- `url`ï¼šç›®æ ‡ URLï¼ˆéœ€åŒ…å«åè®®ï¼Œå¦‚ https://ï¼‰
- `referer`ï¼šReferer è¯·æ±‚å¤´
- `timeout`ï¼šå¯¼èˆªè¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤ 30 ç§’ï¼‰
- `wait_until`ï¼šå¯¼èˆªå®Œæˆæ¡ä»¶ï¼ˆload/domcontentloaded/networkidle/commitï¼‰

### locator
åˆ›å»ºå…ƒç´ å®šä½å™¨ï¼Œç”¨äºåç»­æ“ä½œï¼ˆå®šä½å™¨åœ¨æ‰§è¡Œæ“ä½œå‰å®æ—¶è§£æå…ƒç´ ï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
locator = page.locator("button").has_text("ç¡®è®¤")
locator.click()

# å¼‚æ­¥
locator = page.locator("button").has_text("ç¡®è®¤")
await locator.click()
```

### pdf
å°†é¡µé¢å¯¼å‡ºä¸º PDF æ–‡ä»¶ï¼Œæ”¯æŒè‡ªå®šä¹‰çº¸å¼ å¤§å°ã€è¾¹è·ç­‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šæ¨¡æ‹Ÿå±å¹•åª’ä½“ç±»å‹å¯¼å‡º
page.emulate_media(media="screen")
page.pdf(path="page.pdf")

# å¼‚æ­¥
await page.emulate_media(media="screen")
await page.pdf(path="page.pdf")
```

### screenshot
æ•è·é¡µé¢æˆªå›¾ï¼Œæ”¯æŒå…¨å±ã€è£å‰ªã€æŒ‡å®šæ ¼å¼ç­‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šæ•è·å…¨å± PNG
page.screenshot(path="full_page.png", full_page=True)
# æ•è· JPEG æ ¼å¼ï¼ˆè´¨é‡ 80ï¼‰
page.screenshot(path="image.jpg", type="jpeg", quality=80)

# å¼‚æ­¥
await page.screenshot(path="full_page.png", full_page=True)
```

### set_content
è®¾ç½®é¡µé¢ HTML å†…å®¹ï¼Œå†…éƒ¨è°ƒç”¨ `document.write()`ã€‚

#### ç”¨æ³•
```python
page.set_content("<h1>Hello Playwright</h1>")  # åŒæ­¥
await page.set_content("<h1>Hello Playwright</h1>")  # å¼‚æ­¥
```

### set_viewport_size
è®¾ç½®é¡µé¢è§†å£å¤§å°ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
page.set_viewport_size({"width": 1920, "height": 1080})
# å¼‚æ­¥
await page.set_viewport_size({"width": 1920, "height": 1080})
```

### title
è·å–é¡µé¢æ ‡é¢˜ã€‚

#### ç”¨æ³•
```python
title = page.title()  # åŒæ­¥
title = await page.title()  # å¼‚æ­¥
```

### route
æ‹¦æˆªå¹¶ä¿®æ”¹é¡µé¢ç½‘ç»œè¯·æ±‚ï¼Œæ”¯æŒæŒ‰ URL æ¨¡å¼åŒ¹é…ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šæ‹¦æˆªæ‰€æœ‰å›¾ç‰‡è¯·æ±‚å¹¶ä¸­æ­¢
page.route("**/*.{png,jpg,jpeg}", lambda route: route.abort())
page.goto("https://example.com")

# å¼‚æ­¥
await page.route("**/*.{png,jpg,jpeg}", lambda route: route.abort())
await page.goto("https://example.com")
```

### wait_for_url
ç­‰å¾…é¡µé¢å¯¼èˆªåˆ°æŒ‡å®š URLã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
page.click("a[href='target.html']")
page.wait_for_url("**/target.html")

# å¼‚æ­¥
await page.click("a[href='target.html']")
await page.wait_for_url("**/target.html")
```

## æ ¸å¿ƒå±æ€§
| å±æ€§ | ç”¨é€” | è¿”å›ç±»å‹ |
|------|------|----------|
| clock | æ¨¡æ‹Ÿæ—¶é’Ÿå’Œæ—¶é—´æµé€ï¼ˆv1.45+ï¼‰ | Clock |
| context | è·å–é¡µé¢æ‰€å±çš„æµè§ˆå™¨ä¸Šä¸‹æ–‡ | BrowserContext |
| frames | è·å–é¡µé¢æ‰€æœ‰æ¡†æ¶ | List[Frame] |
| is_closed | æ£€æŸ¥é¡µé¢æ˜¯å¦å·²å…³é—­ | bool |
| keyboard | é”®ç›˜æ“ä½œå¯¹è±¡ | Keyboard |
| main_frame | é¡µé¢ä¸»æ¡†æ¶ | Frame |
| mouse | é¼ æ ‡æ“ä½œå¯¹è±¡ | Mouse |
| url | è·å–å½“å‰é¡µé¢ URL | str |
| viewport_size | è·å–å½“å‰è§†å£å¤§å° | Dictï¼ˆwidth/heightï¼‰ |
| workers | è·å–é¡µé¢å…³è”çš„ WebWorker | List[Worker] |

## å¸¸ç”¨äº‹ä»¶
| äº‹ä»¶ | è§¦å‘æ—¶æœº | äº‹ä»¶æ•°æ® |
|------|----------|----------|
| close | é¡µé¢å…³é—­æ—¶ | Page |
| console | é¡µé¢è°ƒç”¨ console æ–¹æ³•æ—¶ | ConsoleMessage |
| dialog | é¡µé¢å‡ºç°å¼¹çª—æ—¶ï¼ˆalert/confirm ç­‰ï¼‰ | Dialog |
| download | é¡µé¢å¼€å§‹ä¸‹è½½æ—¶ | Download |
| load | é¡µé¢ load äº‹ä»¶è§¦å‘æ—¶ | Page |
| pageerror | é¡µé¢å‘ç”Ÿæœªæ•è·å¼‚å¸¸æ—¶ | Error |
| popup | é¡µé¢æ‰“å¼€æ–°æ ‡ç­¾é¡µæ—¶ | Page |
| request | é¡µé¢å‘èµ·ç½‘ç»œè¯·æ±‚æ—¶ | Request |
| response | é¡µé¢æ”¶åˆ°ç½‘ç»œå“åº”æ—¶ | Response |

## åºŸå¼ƒ/ä¸æ¨èæ–¹æ³•
ä»¥ä¸‹æ–¹æ³•å·²ä¸æ¨èä½¿ç”¨ï¼Œå»ºè®®æ›¿æ¢ä¸º locator ç›¸å…³æ–¹æ³•ï¼š
- check â†’ locator.check()
- click â†’ locator.click()
- dblclick â†’ locator.dblclick()
- fill â†’ locator.fill()
- hover â†’ locator.hover()
- press â†’ locator.press()
- select_option â†’ locator.select_option()
- wait_for_selector â†’ locator.wait_for() æˆ–æ–­è¨€

---

