---
id: intro16
title: 'ğŸ’œ16.BrowserContext'
---

# Playwright for Pythonï¼šBrowserContext ç±»ä¸­æ–‡ç‰ˆæ–‡æ¡£
BrowserContextï¼ˆæµè§ˆå™¨ä¸Šä¸‹æ–‡ï¼‰æ˜¯ Playwright ä¸­çš„æ ¸å¿ƒéš”ç¦»å•å…ƒï¼Œç”¨äºåˆ›å»ºç‹¬ç«‹çš„æµè§ˆå™¨ç¯å¢ƒã€‚ä¸€ä¸ª Browser å®ä¾‹å¯ä»¥åŒ…å«å¤šä¸ª BrowserContextï¼Œæ¯ä¸ªä¸Šä¸‹æ–‡ä¹‹é—´çš„ Cookieã€æœ¬åœ°å­˜å‚¨ï¼ˆLocalStorage/SessionStorageï¼‰ã€ç¼“å­˜ã€æƒé™é…ç½®ç­‰å®Œå…¨éš”ç¦»ï¼Œç›¸å½“äºâ€œè½»é‡çº§æµè§ˆå™¨å®ä¾‹â€ï¼Œé€‚ç”¨äºå¤šè´¦å·å¹¶è¡Œæµ‹è¯•ã€å¤šç¯å¢ƒéš”ç¦»è¿è¡Œç­‰åœºæ™¯ã€‚

## å¿«é€Ÿç¤ºä¾‹
### åŒæ­¥ç¤ºä¾‹
```python
from playwright.sync_api import sync_playwright, Playwright

def run(playwright: Playwright):
    # å¯åŠ¨æµè§ˆå™¨
    browser = playwright.chromium.launch(headless=False)
    
    # åˆ›å»ºç¬¬ä¸€ä¸ªéš”ç¦»ä¸Šä¸‹æ–‡ï¼ˆè´¦å·1ï¼‰
    context1 = browser.new_context(
        viewport={"width": 1920, "height": 1080},
        user_agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
        locale="zh-CN"
    )
    page1 = context1.new_page()
    page1.goto("https://example.com")
    page1.fill("#username", "user1")
    page1.fill("#password", "123456")
    page1.click("#login")
    print("è´¦å·1ç™»å½•åçš„Cookieï¼š", context1.cookies())

    # åˆ›å»ºç¬¬äºŒä¸ªéš”ç¦»ä¸Šä¸‹æ–‡ï¼ˆè´¦å·2ï¼Œä¸è´¦å·1äº’ä¸å¹²æ‰°ï¼‰
    context2 = browser.new_context()
    page2 = context2.new_page()
    page2.goto("https://example.com")
    page2.fill("#username", "user2")
    page2.fill("#password", "654321")
    page2.click("#login")
    print("è´¦å·2ç™»å½•åçš„Cookieï¼š", context2.cookies())

    # å…³é—­èµ„æº
    context1.close()
    context2.close()
    browser.close()

with sync_playwright() as playwright:
    run(playwright)
```

### å¼‚æ­¥ç¤ºä¾‹
```python
import asyncio
from playwright.async_api import async_playwright, Playwright

async def run(playwright: Playwright):
    # å¯åŠ¨ Firefox æµè§ˆå™¨
    browser = await playwright.firefox.launch()
    
    # åˆ›å»ºå¸¦æƒé™é…ç½®çš„ä¸Šä¸‹æ–‡
    context = await browser.new_context(
        geolocation={"latitude": 39.9042, "longitude": 116.4074},
        permissions=["geolocation", "notifications"]
    )
    page = await context.new_page()
    await page.goto("https://example.com")
    print("ä¸Šä¸‹æ–‡å½“å‰URLï¼š", page.url)

    # ä¿å­˜ä¸Šä¸‹æ–‡çŠ¶æ€ï¼ˆCookieã€æœ¬åœ°å­˜å‚¨ç­‰ï¼‰
    await context.storage_state(path="storage.json")
    
    # å…³é—­èµ„æº
    await context.close()
    await browser.close()

async def main():
    async with async_playwright() as playwright:
        await run(playwright)

asyncio.run(main())
```

## æ ¸å¿ƒæ–¹æ³•
### add_cookies
å‘å½“å‰ä¸Šä¸‹æ–‡æ·»åŠ  Cookieï¼ŒCookie ä¼šå¯¹è¯¥ä¸Šä¸‹æ–‡ä¸‹çš„æ‰€æœ‰é¡µé¢ç”Ÿæ•ˆã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
cookies = [
    {
        "name": "auth_token",
        "value": "abc123def456",
        "domain": "example.com",
        "path": "/",
        "expires": 1735689600,  # è¿‡æœŸæ—¶é—´ï¼ˆæ—¶é—´æˆ³ï¼‰
        "httpOnly": True,
        "secure": True
    }
]
context.add_cookies(cookies)

# å¼‚æ­¥
await context.add_cookies(cookies)
```

#### å‚æ•°è¯´æ˜
- `cookies`ï¼šCookie åˆ—è¡¨ï¼Œæ¯ä¸ª Cookie ä¸ºå­—å…¸æ ¼å¼ï¼Œå¿…å¡«å­—æ®µåŒ…æ‹¬ `name`ã€`value`ã€`domain`ã€`path`ã€‚

### add_init_script
åœ¨ä¸Šä¸‹æ–‡å†…æ‰€æœ‰é¡µé¢å¯¼èˆªæˆ–å­æ¡†æ¶é™„åŠ æ—¶æ³¨å…¥åˆå§‹åŒ–è„šæœ¬ï¼Œè„šæœ¬åœ¨é¡µé¢è‡ªèº«è„šæœ¬æ‰§è¡Œå‰è¿è¡Œï¼ˆå…¨å±€ç”Ÿæ•ˆï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šé€šè¿‡æ–‡ä»¶æ³¨å…¥
context.add_init_script(path="./global-preload.js")
# åŒæ­¥ï¼šç›´æ¥æ³¨å…¥è„šæœ¬å­—ç¬¦ä¸²
context.add_init_script(script="window.customConfig = { env: 'test' };")

# å¼‚æ­¥
await context.add_init_script(path="./global-preload.js")
await context.add_init_script(script="window.customConfig = { env: 'test' };")
```

#### å‚æ•°è¯´æ˜
- `path`ï¼šJavaScript æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹å½“å‰å·¥ä½œç›®å½•ï¼‰
- `script`ï¼šåŸå§‹ JavaScript å­—ç¬¦ä¸²

### add_locator_handler
ä¸ºä¸Šä¸‹æ–‡å†…æ‰€æœ‰é¡µé¢æ³¨å†Œæµ®å±‚å¤„ç†é€»è¾‘ï¼Œæ£€æµ‹åˆ°æŒ‡å®šå®šä½å™¨åŒ¹é…çš„å…ƒç´ æ—¶è‡ªåŠ¨æ‰§è¡Œå¤„ç†å‡½æ•°ï¼ˆå…¨å±€æµ®å±‚æ‹¦æˆªï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šå…¨å±€å…³é—­ç™»å½•å¼¹çª—
def handle_login_modal():
    page = context.pages[0]  # è·å–ä¸Šä¸‹æ–‡å½“å‰æ´»è·ƒé¡µé¢
    page.get_by_role("button", name="å…³é—­").click()

context.add_locator_handler(
    locator=context.locator("div.login-modal"),
    handler=handle_login_modal,
    times=3  # æœ€å¤šå¤„ç†3æ¬¡
)

# å¼‚æ­¥
async def handle_login_modal():
    page = context.pages[0]
    await page.get_by_role("button", name="å…³é—­").click()

await context.add_locator_handler(
    locator=context.locator("div.login-modal"),
    handler=handle_login_modal
)
```

### browser
è·å–å½“å‰ä¸Šä¸‹æ–‡æ‰€å±çš„ Browser å®ä¾‹ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
parent_browser = context.browser
print(f"æ‰€å±æµè§ˆå™¨ç±»å‹ï¼š{parent_browser.browser_type.name}")

# å¼‚æ­¥
parent_browser = context.browser
print(f"æ‰€å±æµè§ˆå™¨ç±»å‹ï¼š{parent_browser.browser_type.name}")
```

#### è¿”å›å€¼
`Browser` å®ä¾‹ã€‚

### clear_cookies
æ¸…ç©ºå½“å‰ä¸Šä¸‹æ–‡çš„æ‰€æœ‰ Cookieã€‚

#### ç”¨æ³•
```python
context.clear_cookies()  # åŒæ­¥
await context.clear_cookies()  # å¼‚æ­¥
```

### clear_permissions
æ¸…ç©ºå½“å‰ä¸Šä¸‹æ–‡çš„æ‰€æœ‰å·²æˆäºˆæƒé™ï¼ˆå¦‚åœ°ç†ä½ç½®ã€é€šçŸ¥æƒé™ç­‰ï¼‰ã€‚

#### ç”¨æ³•
```python
context.clear_permissions()  # åŒæ­¥
await context.clear_permissions()  # å¼‚æ­¥
```

### close
å…³é—­å½“å‰æµè§ˆå™¨ä¸Šä¸‹æ–‡ï¼ŒåŒæ—¶å…³é—­è¯¥ä¸Šä¸‹æ–‡ä¸‹çš„æ‰€æœ‰ Page å®ä¾‹ã€‚

#### ç”¨æ³•
```python
context.close()  # åŒæ­¥
await context.close()  # å¼‚æ­¥
```

#### è¯´æ˜
- å…³é—­åä¸Šä¸‹æ–‡ä¸å¯å†ä½¿ç”¨ï¼Œæœªæ‰‹åŠ¨å…³é—­çš„é¡µé¢ä¼šè¢«è‡ªåŠ¨æ¸…ç†
- è‹¥ä¸ºé»˜è®¤ä¸Šä¸‹æ–‡ï¼Œå…³é—­åä¸ä¼šå½±å“ Browser å®ä¾‹æœ¬èº«

### cookies
è·å–å½“å‰ä¸Šä¸‹æ–‡çš„æ‰€æœ‰ Cookieï¼Œè¿”å› Cookie åˆ—è¡¨ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
all_cookies = context.cookies()
# æŒ‰ URL ç­›é€‰ Cookie
filtered_cookies = context.cookies("https://example.com", "https://test.com")
print("å½“å‰Cookieï¼š", all_cookies)

# å¼‚æ­¥
all_cookies = await context.cookies()
filtered_cookies = await context.cookies("https://example.com")
```

#### å‚æ•°è¯´æ˜
- `urls`ï¼ˆå¯é€‰ï¼‰ï¼šURL åˆ—è¡¨ï¼Œç”¨äºç­›é€‰ä»…å¯¹è¿™äº› URL ç”Ÿæ•ˆçš„ Cookieã€‚

#### è¿”å›å€¼
Cookie åˆ—è¡¨ï¼ˆæ¯ä¸ª Cookie ä¸ºå­—å…¸æ ¼å¼ï¼‰ã€‚

### expose_function
å°† Python å‡½æ•°æš´éœ²ç»™æµè§ˆå™¨ä¸Šä¸‹æ–‡çš„ JavaScript ç¯å¢ƒï¼Œå¯åœ¨é¡µé¢ä¸­é€šè¿‡ `window.<å‡½æ•°å>` è°ƒç”¨ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šæš´éœ²Pythonå‡½æ•°ç»™JS
def calculate_sum(a, b):
    return a + b

context.expose_function("jsCalculateSum", calculate_sum)
# åœ¨é¡µé¢ä¸­è°ƒç”¨
page = context.new_page()
result = page.evaluate("window.jsCalculateSum(10, 20)")
print("JSè°ƒç”¨Pythonå‡½æ•°ç»“æœï¼š", result)  # è¾“å‡º 30

# å¼‚æ­¥
async def calculate_sum(a, b):
    return a + b

await context.expose_function("jsCalculateSum", calculate_sum)
page = await context.new_page()
result = await page.evaluate("window.jsCalculateSum(10, 20)")
print("JSè°ƒç”¨Pythonå‡½æ•°ç»“æœï¼š", result)
```

### grant_permissions
ä¸ºå½“å‰ä¸Šä¸‹æ–‡æˆäºˆæŒ‡å®šæƒé™ï¼Œæƒé™å¯¹ä¸Šä¸‹æ–‡å†…æ‰€æœ‰é¡µé¢ç”Ÿæ•ˆã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šæˆäºˆåœ°ç†ä½ç½®å’Œé€šçŸ¥æƒé™
context.grant_permissions(
    permissions=["geolocation", "notifications"],
    origin="https://example.com"  # ä»…å¯¹è¯¥åŸŸåç”Ÿæ•ˆ
)

# å¼‚æ­¥
await context.grant_permissions(
    permissions=["geolocation"],
    origin="https://example.com"
)
```

#### å‚æ•°è¯´æ˜
- `permissions`ï¼šæƒé™åˆ—è¡¨ï¼ˆæ”¯æŒ `geolocation`ã€`notifications`ã€`camera`ã€`microphone` ç­‰ï¼‰
- `origin`ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šæƒé™ç”Ÿæ•ˆçš„åŸŸåï¼Œé»˜è®¤å¯¹æ‰€æœ‰åŸŸåç”Ÿæ•ˆ

### new_page
åœ¨å½“å‰ä¸Šä¸‹æ–‡åˆ›å»ºä¸€ä¸ªæ–°çš„ Pageï¼ˆæ ‡ç­¾é¡µï¼‰ï¼Œé¡µé¢ç»§æ‰¿ä¸Šä¸‹æ–‡çš„æ‰€æœ‰é…ç½®ï¼ˆè§†å£ã€Cookieã€æƒé™ç­‰ï¼‰ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
page1 = context.new_page()
page2 = context.new_page()  # åŒä¸€ä¸Šä¸‹æ–‡ä¸‹çš„ç¬¬äºŒä¸ªé¡µé¢

# å¼‚æ­¥
page1 = await context.new_page()
page2 = await context.new_page()
```

#### è¿”å›å€¼
`Page` å®ä¾‹ã€‚

### new_browser_cdp_session
åˆ›å»ºä¸Šä¸‹æ–‡çº§åˆ«çš„ Chrome DevTools Protocol (CDP) ä¼šè¯ï¼Œç”¨äºå¯¹ä¸Šä¸‹æ–‡è¿›è¡Œåº•å±‚æ§åˆ¶ï¼ˆä»…æ”¯æŒ Chromium å†…æ ¸ï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
cdp_session = context.new_browser_cdp_session()
cdp_session.send("Network.enable")
# æ‹¦æˆªç½‘ç»œè¯·æ±‚
cdp_session.send("Network.setRequestInterception", {"patterns": [{"urlPattern": "*"}]})
cdp_session.detach()

# å¼‚æ­¥
cdp_session = await context.new_browser_cdp_session()
await cdp_session.send("Network.enable")
await cdp_session.send("Network.setRequestInterception", {"patterns": [{"urlPattern": "*"}]})
await cdp_session.detach()
```

#### è¯´æ˜
- ä»…é€‚ç”¨äº Chromium æµè§ˆå™¨ï¼ŒFirefox/WebKit ä¸æ”¯æŒ
- ç”¨äºå®ç° Playwright é«˜å±‚ API æœªè¦†ç›–çš„è‡ªå®šä¹‰æ“ä½œ

### pages
è·å–å½“å‰ä¸Šä¸‹æ–‡ä¸‹æ‰€æœ‰æ´»è·ƒçš„ Page å®ä¾‹åˆ—è¡¨ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
all_pages = context.pages
print(f"ä¸Šä¸‹æ–‡å½“å‰æœ‰ {len(all_pages)} ä¸ªé¡µé¢")
for page in all_pages:
    print("é¡µé¢URLï¼š", page.url)

# å¼‚æ­¥
all_pages = context.pages
print(f"ä¸Šä¸‹æ–‡å½“å‰æœ‰ {len(all_pages)} ä¸ªé¡µé¢")
```

#### è¿”å›å€¼
`List[Page]`ï¼ˆé¡µé¢å®ä¾‹åˆ—è¡¨ï¼‰ã€‚

### route
æ‹¦æˆªå½“å‰ä¸Šä¸‹æ–‡å†…æ‰€æœ‰é¡µé¢çš„ç½‘ç»œè¯·æ±‚ï¼Œæ”¯æŒæŒ‰ URL æ¨¡å¼åŒ¹é…å¹¶è‡ªå®šä¹‰å¤„ç†é€»è¾‘ï¼ˆå…¨å±€è¯·æ±‚æ‹¦æˆªï¼‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šæ‹¦æˆªæ‰€æœ‰å›¾ç‰‡è¯·æ±‚å¹¶è¿”å›è‡ªå®šä¹‰å›¾ç‰‡
def handle_image_route(route):
    # ä¸­æ­¢å›¾ç‰‡è¯·æ±‚
    route.abort()
    # æˆ–è¿”å›è‡ªå®šä¹‰å“åº”
    # route.fulfill(
    #     status=200,
    #     content_type="image/png",
    #     body=open("custom-image.png", "rb").read()
    # )

context.route("**/*.{png,jpg,jpeg,gif}", handle_image_route)
page = context.new_page()
page.goto("https://example.com")

# å¼‚æ­¥
async def handle_image_route(route):
    await route.abort()

await context.route("**/*.{png,jpg,jpeg,gif}", handle_image_route)
page = await context.new_page()
await page.goto("https://example.com")
```

### set_default_navigation_timeout
è®¾ç½®å½“å‰ä¸Šä¸‹æ–‡æ‰€æœ‰é¡µé¢çš„é»˜è®¤å¯¼èˆªè¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¦†ç›– Playwright å…¨å±€é»˜è®¤å€¼ï¼ˆ30000 æ¯«ç§’ï¼‰ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥ï¼šè®¾ç½®å¯¼èˆªè¶…æ—¶ä¸º10ç§’
context.set_default_navigation_timeout(10000)

# å¼‚æ­¥
await context.set_default_navigation_timeout(10000)
```

### set_default_timeout
è®¾ç½®å½“å‰ä¸Šä¸‹æ–‡æ‰€æœ‰æ“ä½œçš„é»˜è®¤è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼ŒåŒ…æ‹¬å…ƒç´ æŸ¥æ‰¾ã€ç‚¹å‡»ç­‰æ“ä½œï¼Œè¦†ç›–å…¨å±€é»˜è®¤å€¼ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥ï¼šè®¾ç½®é»˜è®¤æ“ä½œè¶…æ—¶ä¸º5ç§’
context.set_default_timeout(5000)

# å¼‚æ­¥
await context.set_default_timeout(5000)
```

### set_extra_http_headers
ä¸ºå½“å‰ä¸Šä¸‹æ–‡æ‰€æœ‰é¡µé¢çš„ç½‘ç»œè¯·æ±‚è®¾ç½®é¢å¤–çš„ HTTP è¯·æ±‚å¤´ï¼Œå…¨å±€ç”Ÿæ•ˆã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
headers = {
    "X-Test-Header": "Playwright-Test",
    "Authorization": "Bearer abc123"
}
context.set_extra_http_headers(headers)

# å¼‚æ­¥
await context.set_extra_http_headers(headers)
```

### set_geolocation
è®¾ç½®å½“å‰ä¸Šä¸‹æ–‡çš„åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œéœ€å…ˆæˆäºˆ `geolocation` æƒé™ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥
context.set_geolocation({
    "latitude": 31.2304,
    "longitude": 121.4737,
    "accuracy": 100  # å®šä½ç²¾åº¦ï¼ˆç±³ï¼‰
})

# å¼‚æ­¥
await context.set_geolocation({
    "latitude": 31.2304,
    "longitude": 121.4737
})
```

### set_locale
è®¾ç½®å½“å‰ä¸Šä¸‹æ–‡çš„è¯­è¨€ç¯å¢ƒï¼ˆå¦‚ `zh-CN`ã€`en-US`ï¼‰ï¼Œå½±å“é¡µé¢çš„è¯­è¨€æ¸²æŸ“å’Œ HTTP è¯·æ±‚å¤´çš„ `Accept-Language`ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
context.set_locale("zh-CN")

# å¼‚æ­¥
await context.set_locale("zh-CN")
```

### set_offline
åˆ‡æ¢å½“å‰ä¸Šä¸‹æ–‡çš„ç¦»çº¿çŠ¶æ€ï¼Œæ¨¡æ‹Ÿç½‘ç»œæ–­å¼€/æ¢å¤åœºæ™¯ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šå¼€å¯ç¦»çº¿æ¨¡å¼
context.set_offline(True)
# æ¢å¤ç½‘ç»œè¿æ¥
context.set_offline(False)

# å¼‚æ­¥
await context.set_offline(True)
await context.set_offline(False)
```

### set_storage_state
åŠ è½½å·²ä¿å­˜çš„å­˜å‚¨çŠ¶æ€ï¼ˆCookieã€LocalStorageã€SessionStorage ç­‰ï¼‰ï¼Œç”¨äºæ¢å¤ä¸Šä¸‹æ–‡çš„ç™»å½•çŠ¶æ€ç­‰ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šä»æ–‡ä»¶åŠ è½½å­˜å‚¨çŠ¶æ€
context.set_storage_state(path="storage.json")
# ä»å­—å…¸åŠ è½½å­˜å‚¨çŠ¶æ€
storage_state = {"cookies": [], "origins": []}
context.set_storage_state(state=storage_state)

# å¼‚æ­¥
await context.set_storage_state(path="storage.json")
await context.set_storage_state(state=storage_state)
```

### storage_state
è·å–å½“å‰ä¸Šä¸‹æ–‡çš„å­˜å‚¨çŠ¶æ€ï¼ˆCookieã€LocalStorageã€SessionStorage ç­‰ï¼‰ï¼Œå¯ä¿å­˜ä¸ºæ–‡ä»¶æˆ–å­—å…¸ç”¨äºåç»­æ¢å¤ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šä¿å­˜åˆ°æ–‡ä»¶
context.storage_state(path="storage.json")
# è·å–å­˜å‚¨çŠ¶æ€å­—å…¸
storage_state = context.storage_state()

# å¼‚æ­¥
await context.storage_state(path="storage.json")
storage_state = await context.storage_state()
```

### unroute
ç§»é™¤ä¹‹å‰é€šè¿‡ `route` æ³¨å†Œçš„è¯·æ±‚æ‹¦æˆªè§„åˆ™ï¼Œåœæ­¢æ‹¦æˆªæŒ‡å®šæ¨¡å¼çš„ç½‘ç»œè¯·æ±‚ã€‚

#### ç”¨æ³•
```python
# åŒæ­¥
context.unroute("**/*.{png,jpg,jpeg}")
# ç§»é™¤æŒ‡å®šå¤„ç†å‡½æ•°çš„æ‹¦æˆªè§„åˆ™
context.unroute("**/*.png", handle_image_route)

# å¼‚æ­¥
await context.unroute("**/*.{png,jpg,jpeg}")
await context.unroute("**/*.png", handle_image_route)
```

### wait_for_event
ç­‰å¾…ä¸Šä¸‹æ–‡è§¦å‘æŒ‡å®šäº‹ä»¶ï¼Œå¹¶è¿”å›äº‹ä»¶ç›¸å…³æ•°æ®ï¼Œæ”¯æŒè¶…æ—¶é…ç½®ã€‚

#### ç”¨æ³•ç¤ºä¾‹
```python
# åŒæ­¥ï¼šç­‰å¾…æ–°é¡µé¢åˆ›å»º
new_page = context.wait_for_event("page", timeout=10000)
print("æ–°é¡µé¢URLï¼š", new_page.url)

# å¼‚æ­¥
new_page = await context.wait_for_event("page", timeout=10000)
print("æ–°é¡µé¢URLï¼š", new_page.url)
```

## æ ¸å¿ƒå±æ€§
| å±æ€§ | ç”¨é€” | è¿”å›ç±»å‹ | è¯´æ˜ |
|------|------|----------|------|
| `browser` | è·å–æ‰€å±æµè§ˆå™¨å®ä¾‹ | Browser | æ‰€æœ‰ç‰ˆæœ¬æ”¯æŒ |
| `is_closed` | æ£€æŸ¥ä¸Šä¸‹æ–‡æ˜¯å¦å·²å…³é—­ | bool | æ‰€æœ‰ç‰ˆæœ¬æ”¯æŒ |
| `pages` | è·å–å½“å‰æ´»è·ƒé¡µé¢åˆ—è¡¨ | List[Page] | æ‰€æœ‰ç‰ˆæœ¬æ”¯æŒ |
| `viewport_size` | è·å–/è®¾ç½®ä¸Šä¸‹æ–‡é»˜è®¤è§†å£å¤§å° | Dictï¼ˆwidth/heightï¼‰ | å¯ç›´æ¥èµ‹å€¼ä¿®æ”¹ï¼Œå¦‚ `context.viewport_size = {"width": 1280, "height": 720}` |

## å¸¸ç”¨äº‹ä»¶
| äº‹ä»¶ | è§¦å‘æ—¶æœº | äº‹ä»¶æ•°æ® | è¯´æ˜ |
|------|----------|----------|------|
| `close` | ä¸Šä¸‹æ–‡è¢«å…³é—­æ—¶ | BrowserContext | å…³é—­åè§¦å‘ |
| `page` | ä¸Šä¸‹æ–‡å†…åˆ›å»ºæ–°é¡µé¢æ—¶ | Page | åŒ…æ‹¬ `new_page()` æˆ–é¡µé¢è·³è½¬æ‰“å¼€çš„æ–°é¡µé¢ |
| `request` | ä¸Šä¸‹æ–‡å†…é¡µé¢å‘èµ·ç½‘ç»œè¯·æ±‚æ—¶ | Request | å…¨å±€è¯·æ±‚äº‹ä»¶ |
| `response` | ä¸Šä¸‹æ–‡å†…é¡µé¢æ”¶åˆ°ç½‘ç»œå“åº”æ—¶ | Response | å…¨å±€å“åº”äº‹ä»¶ |
| `route` | ç½‘ç»œè¯·æ±‚åŒ¹é… `route` æ‹¦æˆªè§„åˆ™æ—¶ | Route | ç”¨äºè‡ªå®šä¹‰è¯·æ±‚å¤„ç† |
| `download` | ä¸Šä¸‹æ–‡å†…é¡µé¢å¼€å§‹ä¸‹è½½æ–‡ä»¶æ—¶ | Download | å…¨å±€ä¸‹è½½äº‹ä»¶ |
| `dialog` | ä¸Šä¸‹æ–‡å†…é¡µé¢å¼¹å‡ºå¯¹è¯æ¡†æ—¶ï¼ˆalert/confirm ç­‰ï¼‰ | Dialog | å…¨å±€å¼¹çª—äº‹ä»¶ |

## é‡è¦è¯´æ˜
1.  **éš”ç¦»æ€§æ ¸å¿ƒ**ï¼šBrowserContext æ˜¯ Playwright å®ç°ç¯å¢ƒéš”ç¦»çš„æ ¸å¿ƒï¼Œä¸åŒä¸Šä¸‹æ–‡ä¹‹é—´æ— ä»»ä½•çŠ¶æ€å…±äº«ï¼Œé€‚åˆå¤šè´¦å·å¹¶è¡Œæµ‹è¯•ã€å¤šåœºæ™¯éš”ç¦»éªŒè¯ã€‚
2.  **çŠ¶æ€å¤ç”¨**ï¼šé€šè¿‡ `storage_state()` ä¿å­˜ç™»å½•çŠ¶æ€ï¼Œ`set_storage_state()` æ¢å¤çŠ¶æ€ï¼Œå¯è·³è¿‡é‡å¤ç™»å½•æµç¨‹ï¼Œæå‡æµ‹è¯•æ•ˆç‡ã€‚
3.  **å…¨å±€é…ç½®**ï¼šä¸Šä¸‹æ–‡çº§åˆ«çš„é…ç½®ï¼ˆå¦‚è¶…æ—¶æ—¶é—´ã€HTTP å¤´ã€æƒé™ï¼‰ä¼šç»§æ‰¿ç»™æ‰€æœ‰å­é¡µé¢ï¼Œæ— éœ€åœ¨æ¯ä¸ªé¡µé¢å•ç‹¬é…ç½®ã€‚
4.  **èµ„æºä¼˜åŒ–**ï¼šç›¸æ¯”å¯åŠ¨å¤šä¸ª Browser å®ä¾‹ï¼Œåˆ›å»ºå¤šä¸ª BrowserContext æ›´èŠ‚çœç³»ç»Ÿèµ„æºï¼Œæ˜¯å¤šç¯å¢ƒæµ‹è¯•çš„é¦–é€‰æ–¹æ¡ˆã€‚
5.  **é»˜è®¤ä¸Šä¸‹æ–‡**ï¼šè‹¥ç›´æ¥é€šè¿‡ `browser.new_page()` åˆ›å»ºé¡µé¢ï¼ŒPlaywright ä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤ä¸Šä¸‹æ–‡ï¼Œå¯é€šè¿‡ `browser.context` è·å–ã€‚

---

è¦ä¸è¦æˆ‘å¸®ä½ æ•´ç† **BrowserContext å®æˆ˜åœºæ™¯æ¨¡æ¿**ï¼ŒåŒ…å«å¤šè´¦å·å¹¶è¡Œæµ‹è¯•ã€ç™»å½•çŠ¶æ€å¤ç”¨ã€å…¨å±€è¯·æ±‚æ‹¦æˆªç­‰å¯ç›´æ¥è¿è¡Œçš„ä»£ç ç¤ºä¾‹ï¼Ÿ