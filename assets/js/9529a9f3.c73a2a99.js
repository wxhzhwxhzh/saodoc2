"use strict";(globalThis.webpackChunkmy_tutorial_site=globalThis.webpackChunkmy_tutorial_site||[]).push([[325],{5167:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>u,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"\u5176\u4ed6/cdp/intro5","title":"\ud83d\udfe0Runtime","description":"","source":"@site/docs/\u5176\u4ed6/cdp/5.runtime.md","sourceDirName":"\u5176\u4ed6/cdp","slug":"/\u5176\u4ed6/cdp/intro5","permalink":"/saodoc2/docs/\u5176\u4ed6/cdp/intro5","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"id":"intro5","permalink":"/cdp/p5","title":"\ud83d\udfe0Runtime"},"sidebar":"otherSidebar","previous":{"title":"\ud83d\udfe0Target","permalink":"/saodoc2/docs/\u5176\u4ed6/cdp/intro4"},"next":{"title":"Emoji","permalink":"/saodoc2/docs/category/emoji"}}');var s=t(4848),i=t(8453);const a={id:"intro5",permalink:"/cdp/p5",title:"\ud83d\udfe0Runtime"},o="Runtime",u={},l=[];function m(n){const e={code:"code",h1:"h1",header:"header",pre:"pre",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"runtime",children:"Runtime"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'        \nimport json\nimport websocket\nimport requests\nimport time\nimport threading\nfrom datetime import datetime\n\ndef get_websocket_url(port=9222):\n    """\u83b7\u53d6 WebSocket \u8c03\u8bd5 URL"""\n    response = requests.get(f\'http://localhost:{port}/json\')\n    tabs = response.json()\n    return tabs[0][\'webSocketDebuggerUrl\']\n\nclass CDPRuntime:\n    """CDP Runtime \u5c01\u88c5\u7c7b"""\n    \n    def __init__(self, ws_url):\n        self.ws = websocket.create_connection(ws_url)\n        self.command_id = 0\n        self.event_handlers = {}\n        self.running = True\n        self.events_log = []\n        \n        # \u542f\u52a8\u4e8b\u4ef6\u76d1\u542c\u7ebf\u7a0b\n        self.event_thread = threading.Thread(target=self._event_listener, daemon=True)\n        self.event_thread.start()\n        \n    def send_command(self, method, params=None):\n        """\u53d1\u9001 CDP \u547d\u4ee4"""\n        self.command_id += 1\n        command = {\n            "id": self.command_id,\n            "method": method,\n            "params": params or {}\n        }\n        print(f"\\n>>> \u53d1\u9001\u547d\u4ee4: {method}")\n        if params:\n            params_str = json.dumps(params, indent=6, ensure_ascii=False)\n            if len(params_str) > 500:\n                params_str = params_str[:500] + "..."\n            print(f"    \u53c2\u6570: {params_str}")\n        \n        self.ws.send(json.dumps(command))\n        \n        # \u7b49\u5f85\u54cd\u5e94\n        start_time = time.time()\n        while time.time() - start_time < 10:  # 10\u79d2\u8d85\u65f6\n            try:\n                response = json.loads(self.ws.recv())\n                if \'id\' in response and response[\'id\'] == self.command_id:\n                    if \'error\' not in response:\n                        print(f"<<< \u54cd\u5e94\u6210\u529f")\n                        if \'result\' in response:\n                            result_str = json.dumps(response[\'result\'], indent=6, ensure_ascii=False)\n                            if len(result_str) > 500:\n                                result_str = result_str[:500] + "..."\n                            print(f"    \u7ed3\u679c: {result_str}")\n                    else:\n                        print(f"<<< \u9519\u8bef: {response[\'error\']}")\n                    return response\n                elif \'method\' in response:\n                    self._handle_event(response)\n            except Exception as e:\n                continue\n        \n        print(f"<<< \u8d85\u65f6")\n        return {"error": "timeout"}\n    \n    def _event_listener(self):\n        """\u540e\u53f0\u76d1\u542c\u4e8b\u4ef6"""\n        while self.running:\n            try:\n                self.ws.settimeout(0.1)\n                message = self.ws.recv()\n                data = json.loads(message)\n                if \'method\' in data:\n                    self._handle_event(data)\n            except:\n                continue\n    \n    def _handle_event(self, event):\n        """\u5904\u7406\u4e8b\u4ef6"""\n        method = event[\'method\']\n        self.events_log.append({\n            \'timestamp\': datetime.now().isoformat(),\n            \'method\': method,\n            \'params\': event.get(\'params\', {})\n        })\n        \n        if method in self.event_handlers:\n            self.event_handlers[method](event)\n    \n    def on_event(self, event_name, handler):\n        """\u6ce8\u518c\u4e8b\u4ef6\u5904\u7406\u5668"""\n        self.event_handlers[event_name] = handler\n    \n    def close(self):\n        self.running = False\n        time.sleep(0.2)\n        self.ws.close()\n\n\n# ========================================\n# \u793a\u4f8b 1: \u57fa\u7840 JavaScript \u6267\u884c\n# ========================================\ndef example_basic_evaluation():\n    """\n    \u6f14\u793a\u57fa\u7840 JavaScript \u6267\u884c:\n    1. Runtime.enable - \u542f\u7528\u8fd0\u884c\u65f6\n    2. Runtime.evaluate - \u6267\u884c\u8868\u8fbe\u5f0f\n    3. \u4e0d\u540c\u7684\u8fd4\u56de\u503c\u7c7b\u578b\n    4. returnByValue vs objectId\n    """\n    print("\\n" + "="*60)\n    print("\u793a\u4f8b 1: \u57fa\u7840 JavaScript \u6267\u884c")\n    print("="*60)\n    \n    runtime = CDPRuntime(get_websocket_url())\n    \n    # 1. \u542f\u7528 Runtime\n    print("\\n--- \u542f\u7528 Runtime ---")\n    runtime.send_command("Runtime.enable")\n    runtime.send_command("Page.enable")\n    runtime.send_command("Page.navigate", {"url": "https://example.com"})\n    time.sleep(2)\n    \n    # 2. \u6267\u884c\u7b80\u5355\u8868\u8fbe\u5f0f\n    print("\\n--- \u6267\u884c\u7b80\u5355\u8868\u8fbe\u5f0f ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": "1 + 1",\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        value = result[\'result\'][\'result\'][\'value\']\n        print(f"    \u8ba1\u7b97\u7ed3\u679c: {value}")\n    \n    # 3. \u83b7\u53d6\u9875\u9762\u4fe1\u606f\n    print("\\n--- \u83b7\u53d6\u9875\u9762\u4fe1\u606f ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": "document.title",\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        title = result[\'result\'][\'result\'][\'value\']\n        print(f"    \u9875\u9762\u6807\u9898: {title}")\n    \n    # 4. \u6267\u884c\u590d\u6742\u5bf9\u8c61\u5e76\u8fd4\u56de\u503c\n    print("\\n--- \u8fd4\u56de\u5bf9\u8c61 (returnByValue) ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            ({\n                url: window.location.href,\n                width: window.innerWidth,\n                height: window.innerHeight,\n                userAgent: navigator.userAgent.substring(0, 50)\n            })\n        """,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        obj = result[\'result\'][\'result\'][\'value\']\n        print(f"    \u8fd4\u56de\u5bf9\u8c61: {json.dumps(obj, indent=8, ensure_ascii=False)}")\n    \n    # 5. \u83b7\u53d6\u5bf9\u8c61\u5f15\u7528 (objectId)\n    print("\\n--- \u83b7\u53d6\u5bf9\u8c61\u5f15\u7528 (objectId) ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": "document.body",\n        "returnByValue": False  # \u8fd4\u56de\u5bf9\u8c61\u5f15\u7528\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        object_id = result[\'result\'][\'result\'].get(\'objectId\')\n        if object_id:\n            print(f"    \u5bf9\u8c61 ID: {object_id[:50]}...")\n            print(f"    \u7c7b\u578b: {result[\'result\'][\'result\'].get(\'type\')}")\n            print(f"    \u5b50\u7c7b\u578b: {result[\'result\'][\'result\'].get(\'subtype\')}")\n    \n    # 6. \u6267\u884c\u5f02\u6b65\u4ee3\u7801\n    print("\\n--- \u6267\u884c\u5f02\u6b65\u4ee3\u7801 (Promise) ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve(\'\u5f02\u6b65\u7ed3\u679c: \u5ef6\u8fdf1\u79d2\');\n                }, 1000);\n            })\n        """,\n        "awaitPromise": True,  # \u7b49\u5f85 Promise \u5b8c\u6210\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        value = result[\'result\'][\'result\'][\'value\']\n        print(f"    \u5f02\u6b65\u7ed3\u679c: {value}")\n    \n    runtime.close()\n\n\n# ========================================\n# \u793a\u4f8b 2: \u5bf9\u8c61\u5c5e\u6027\u68c0\u67e5\n# ========================================\ndef example_object_inspection():\n    """\n    \u6f14\u793a\u5bf9\u8c61\u68c0\u67e5:\n    1. Runtime.getProperties - \u83b7\u53d6\u5bf9\u8c61\u5c5e\u6027\n    2. Runtime.callFunctionOn - \u5728\u5bf9\u8c61\u4e0a\u8c03\u7528\u51fd\u6570\n    3. Runtime.releaseObject - \u91ca\u653e\u5bf9\u8c61\n    4. Runtime.releaseObjectGroup - \u91ca\u653e\u5bf9\u8c61\u7ec4\n    """\n    print("\\n" + "="*60)\n    print("\u793a\u4f8b 2: \u5bf9\u8c61\u5c5e\u6027\u68c0\u67e5")\n    print("="*60)\n    \n    runtime = CDPRuntime(get_websocket_url())\n    runtime.send_command("Runtime.enable")\n    runtime.send_command("Page.enable")\n    runtime.send_command("Page.navigate", {"url": "https://example.com"})\n    time.sleep(2)\n    \n    # 1. \u83b7\u53d6 window \u5bf9\u8c61\n    print("\\n--- \u83b7\u53d6 window \u5bf9\u8c61\u5f15\u7528 ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": "window",\n        "returnByValue": False\n    })\n    \n    window_object_id = None\n    if \'result\' in result and \'result\' in result[\'result\']:\n        window_object_id = result[\'result\'][\'result\'].get(\'objectId\')\n        print(f"    Window \u5bf9\u8c61 ID: {window_object_id[:50]}...")\n    \n    # 2. \u83b7\u53d6 window \u5bf9\u8c61\u7684\u5c5e\u6027\n    if window_object_id:\n        print("\\n--- \u83b7\u53d6 window \u5bf9\u8c61\u7684\u5c5e\u6027 ---")\n        props = runtime.send_command("Runtime.getProperties", {\n            "objectId": window_object_id,\n            "ownProperties": True,  # \u53ea\u83b7\u53d6\u81ea\u6709\u5c5e\u6027\n            "accessorPropertiesOnly": False,\n            "generatePreview": True\n        })\n        \n        if \'result\' in props and \'result\' in props[\'result\']:\n            properties = props[\'result\'][\'result\']\n            print(f"    \u5c5e\u6027\u6570\u91cf: {len(properties)}")\n            print(f"\\n    \u524d10\u4e2a\u5c5e\u6027:")\n            for i, prop in enumerate(properties[:10], 1):\n                name = prop.get(\'name\', \'N/A\')\n                value = prop.get(\'value\', {})\n                prop_type = value.get(\'type\', \'N/A\')\n                print(f"      {i}. {name}: {prop_type}")\n    \n    # 3. \u83b7\u53d6 document \u5bf9\u8c61\u5e76\u68c0\u67e5\n    print("\\n--- \u68c0\u67e5 document \u5bf9\u8c61 ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": "document",\n        "returnByValue": False\n    })\n    \n    doc_object_id = None\n    if \'result\' in result and \'result\' in result[\'result\']:\n        doc_object_id = result[\'result\'][\'result\'].get(\'objectId\')\n    \n    if doc_object_id:\n        props = runtime.send_command("Runtime.getProperties", {\n            "objectId": doc_object_id,\n            "ownProperties": False  # \u5305\u62ec\u539f\u578b\u94fe\n        })\n        \n        if \'result\' in props and \'result\' in props[\'result\']:\n            # \u67e5\u627e\u7279\u5b9a\u5c5e\u6027\n            properties = props[\'result\'][\'result\']\n            interesting_props = [\'title\', \'URL\', \'domain\', \'readyState\']\n            \n            print(f"    \u6587\u6863\u5c5e\u6027:")\n            for prop in properties:\n                if prop.get(\'name\') in interesting_props:\n                    name = prop[\'name\']\n                    value = prop.get(\'value\', {})\n                    if \'value\' in value:\n                        print(f"      {name}: {value[\'value\']}")\n    \n    # 4. \u5728\u5bf9\u8c61\u4e0a\u8c03\u7528\u51fd\u6570\n    if doc_object_id:\n        print("\\n--- \u5728 document \u4e0a\u8c03\u7528\u51fd\u6570 ---")\n        result = runtime.send_command("Runtime.callFunctionOn", {\n            "objectId": doc_object_id,\n            "functionDeclaration": """\n                function() {\n                    return {\n                        elementCount: this.getElementsByTagName(\'*\').length,\n                        linkCount: this.getElementsByTagName(\'a\').length,\n                        imageCount: this.getElementsByTagName(\'img\').length\n                    };\n                }\n            """,\n            "returnByValue": True\n        })\n        \n        if \'result\' in result and \'result\' in result[\'result\']:\n            stats = result[\'result\'][\'result\'][\'value\']\n            print(f"    \u9875\u9762\u7edf\u8ba1: {json.dumps(stats, indent=8)}")\n    \n    # 5. \u91ca\u653e\u5bf9\u8c61\n    print("\\n--- \u91ca\u653e\u5bf9\u8c61\u5f15\u7528 ---")\n    if window_object_id:\n        runtime.send_command("Runtime.releaseObject", {\n            "objectId": window_object_id\n        })\n        print(f"    \u5df2\u91ca\u653e window \u5bf9\u8c61")\n    \n    if doc_object_id:\n        runtime.send_command("Runtime.releaseObject", {\n            "objectId": doc_object_id\n        })\n        print(f"    \u5df2\u91ca\u653e document \u5bf9\u8c61")\n    \n    runtime.close()\n\n\n# ========================================\n# \u793a\u4f8b 3: \u63a7\u5236\u53f0\u6d88\u606f\u5904\u7406\n# ========================================\ndef example_console_handling():\n    """\n    \u6f14\u793a\u63a7\u5236\u53f0\u6d88\u606f\u5904\u7406:\n    1. Runtime.consoleAPICalled - \u63a7\u5236\u53f0 API \u8c03\u7528\n    2. Runtime.exceptionThrown - \u5f02\u5e38\u629b\u51fa\n    3. \u4e0d\u540c\u7c7b\u578b\u7684\u63a7\u5236\u53f0\u6d88\u606f\n    """\n    print("\\n" + "="*60)\n    print("\u793a\u4f8b 3: \u63a7\u5236\u53f0\u6d88\u606f\u5904\u7406")\n    print("="*60)\n    \n    runtime = CDPRuntime(get_websocket_url())\n    \n    console_messages = []\n    exceptions = []\n    \n    def handle_console_api(event):\n        params = event[\'params\']\n        msg_type = params.get(\'type\', \'log\')\n        args = params.get(\'args\', [])\n        \n        # \u63d0\u53d6\u53c2\u6570\u503c\n        values = []\n        for arg in args:\n            if \'value\' in arg:\n                values.append(str(arg[\'value\']))\n            elif \'description\' in arg:\n                values.append(arg[\'description\'])\n            else:\n                values.append(str(arg.get(\'type\', \'unknown\')))\n        \n        message = \' \'.join(values)\n        console_messages.append({\n            \'type\': msg_type,\n            \'message\': message,\n            \'timestamp\': params.get(\'timestamp\')\n        })\n        \n        icon = {\n            \'log\': \'\ud83d\udcdd\',\n            \'info\': \'\u2139\ufe0f\',\n            \'warn\': \'\u26a0\ufe0f\',\n            \'error\': \'\u274c\',\n            \'debug\': \'\ud83d\udc1b\'\n        }.get(msg_type, \'\ud83d\udcdd\')\n        \n        print(f"\\n{icon} \u63a7\u5236\u53f0 [{msg_type}]: {message}")\n    \n    def handle_exception(event):\n        params = event[\'params\']\n        exception_details = params.get(\'exceptionDetails\', {})\n        \n        text = exception_details.get(\'text\', \'N/A\')\n        exception = exception_details.get(\'exception\', {})\n        description = exception.get(\'description\', \'\')\n        \n        exceptions.append({\n            \'text\': text,\n            \'description\': description,\n            \'timestamp\': params.get(\'timestamp\')\n        })\n        \n        print(f"\\n\ud83d\udca5 JavaScript \u5f02\u5e38:")\n        print(f"    \u9519\u8bef: {text}")\n        if description:\n            print(f"    \u63cf\u8ff0: {description[:200]}")\n    \n    runtime.on_event("Runtime.consoleAPICalled", handle_console_api)\n    runtime.on_event("Runtime.exceptionThrown", handle_exception)\n    \n    runtime.send_command("Runtime.enable")\n    runtime.send_command("Page.enable")\n    runtime.send_command("Page.navigate", {"url": "https://example.com"})\n    time.sleep(2)\n    \n    # 1. \u89e6\u53d1\u4e0d\u540c\u7c7b\u578b\u7684\u63a7\u5236\u53f0\u6d88\u606f\n    print("\\n--- \u89e6\u53d1\u63a7\u5236\u53f0\u6d88\u606f ---")\n    \n    runtime.send_command("Runtime.evaluate", {\n        "expression": "console.log(\'\u8fd9\u662f\u4e00\u6761\u65e5\u5fd7\u6d88\u606f\')"\n    })\n    \n    runtime.send_command("Runtime.evaluate", {\n        "expression": "console.info(\'\u8fd9\u662f\u4e00\u6761\u4fe1\u606f\u6d88\u606f\')"\n    })\n    \n    runtime.send_command("Runtime.evaluate", {\n        "expression": "console.warn(\'\u8fd9\u662f\u4e00\u6761\u8b66\u544a\u6d88\u606f\')"\n    })\n    \n    runtime.send_command("Runtime.evaluate", {\n        "expression": "console.error(\'\u8fd9\u662f\u4e00\u6761\u9519\u8bef\u6d88\u606f\')"\n    })\n    \n    # 2. \u8f93\u51fa\u5bf9\u8c61\n    print("\\n--- \u8f93\u51fa\u5bf9\u8c61 ---")\n    runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            console.log(\'\u7528\u6237\u4fe1\u606f:\', {\n                name: \'Alice\',\n                age: 30,\n                role: \'Developer\'\n            })\n        """\n    })\n    \n    # 3. \u89e6\u53d1\u5f02\u5e38\n    print("\\n--- \u89e6\u53d1\u5f02\u5e38 ---")\n    runtime.send_command("Runtime.evaluate", {\n        "expression": "throw new Error(\'\u8fd9\u662f\u4e00\u4e2a\u6d4b\u8bd5\u9519\u8bef\')"\n    })\n    \n    runtime.send_command("Runtime.evaluate", {\n        "expression": "undefinedFunction()"  # \u5f15\u7528\u9519\u8bef\n    })\n    \n    time.sleep(2)\n    \n    # 4. \u663e\u793a\u7edf\u8ba1\n    print("\\n" + "="*60)\n    print(f"\ud83d\udcca \u7edf\u8ba1:")\n    print(f"    \u63a7\u5236\u53f0\u6d88\u606f: {len(console_messages)} \u6761")\n    print(f"    \u5f02\u5e38: {len(exceptions)} \u4e2a")\n    \n    if console_messages:\n        print(f"\\n\u63a7\u5236\u53f0\u6d88\u606f\u7c7b\u578b\u5206\u5e03:")\n        types_count = {}\n        for msg in console_messages:\n            t = msg[\'type\']\n            types_count[t] = types_count.get(t, 0) + 1\n        for t, count in types_count.items():\n            print(f"      {t}: {count}")\n    print("="*60)\n    \n    runtime.close()\n\n\n# ========================================\n# \u793a\u4f8b 4: \u6267\u884c\u4e0a\u4e0b\u6587\u7ba1\u7406\n# ========================================\ndef example_execution_contexts():\n    """\n    \u6f14\u793a\u6267\u884c\u4e0a\u4e0b\u6587\u7ba1\u7406:\n    1. Runtime.executionContextCreated - \u4e0a\u4e0b\u6587\u521b\u5efa\n    2. Runtime.executionContextDestroyed - \u4e0a\u4e0b\u6587\u9500\u6bc1\n    3. \u5728\u4e0d\u540c\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4ee3\u7801\n    4. iframe \u4e0a\u4e0b\u6587\n    """\n    print("\\n" + "="*60)\n    print("\u793a\u4f8b 4: \u6267\u884c\u4e0a\u4e0b\u6587\u7ba1\u7406")\n    print("="*60)\n    \n    runtime = CDPRuntime(get_websocket_url())\n    \n    contexts = {}\n    \n    def handle_context_created(event):\n        context = event[\'params\'][\'context\']\n        context_id = context[\'id\']\n        name = context.get(\'name\', \'unnamed\')\n        origin = context.get(\'origin\', \'N/A\')\n        \n        contexts[context_id] = context\n        \n        print(f"\\n\ud83c\udd95 \u6267\u884c\u4e0a\u4e0b\u6587\u521b\u5efa:")\n        print(f"    ID: {context_id}")\n        print(f"    \u540d\u79f0: {name}")\n        print(f"    \u6765\u6e90: {origin}")\n        print(f"    \u662f\u5426\u9ed8\u8ba4: {context.get(\'auxData\', {}).get(\'isDefault\', False)}")\n    \n    def handle_context_destroyed(event):\n        context_id = event[\'params\'][\'executionContextId\']\n        if context_id in contexts:\n            del contexts[context_id]\n        print(f"\\n\u274c \u6267\u884c\u4e0a\u4e0b\u6587\u9500\u6bc1: {context_id}")\n    \n    runtime.on_event("Runtime.executionContextCreated", handle_context_created)\n    runtime.on_event("Runtime.executionContextDestroyed", handle_context_destroyed)\n    \n    runtime.send_command("Runtime.enable")\n    runtime.send_command("Page.enable")\n    \n    # 1. \u5bfc\u822a\u5230\u6709 iframe \u7684\u9875\u9762\n    print("\\n--- \u5bfc\u822a\u5230\u5305\u542b iframe \u7684\u9875\u9762 ---")\n    runtime.send_command("Page.navigate", {\n        "url": "data:text/html,<html><body><h1>\u4e3b\u9875\u9762</h1><iframe src=\'data:text/html,<h1>iframe</h1>\'></iframe></body></html>"\n    })\n    \n    time.sleep(3)\n    \n    # 2. \u663e\u793a\u6240\u6709\u6267\u884c\u4e0a\u4e0b\u6587\n    print("\\n--- \u5f53\u524d\u6267\u884c\u4e0a\u4e0b\u6587 ---")\n    print(f"    \u4e0a\u4e0b\u6587\u6570\u91cf: {len(contexts)}")\n    for i, (ctx_id, ctx) in enumerate(contexts.items(), 1):\n        print(f"\\n  {i}. \u4e0a\u4e0b\u6587 ID: {ctx_id}")\n        print(f"     \u540d\u79f0: {ctx.get(\'name\', \'N/A\')}")\n        print(f"     \u6765\u6e90: {ctx.get(\'origin\', \'N/A\')}")\n    \n    # 3. \u5728\u4e3b\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4ee3\u7801\n    print("\\n--- \u5728\u4e3b\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c ---")\n    main_context = None\n    for ctx_id, ctx in contexts.items():\n        if ctx.get(\'auxData\', {}).get(\'isDefault\'):\n            main_context = ctx_id\n            break\n    \n    if main_context:\n        result = runtime.send_command("Runtime.evaluate", {\n            "expression": "document.querySelector(\'h1\').textContent",\n            "contextId": main_context,\n            "returnByValue": True\n        })\n        \n        if \'result\' in result and \'result\' in result[\'result\']:\n            print(f"    \u4e3b\u9875\u9762 h1: {result[\'result\'][\'result\'][\'value\']}")\n    \n    # 4. \u5728\u6240\u6709\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\n    print("\\n--- \u5728\u6240\u6709\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c ---")\n    for ctx_id in contexts.keys():\n        result = runtime.send_command("Runtime.evaluate", {\n            "expression": "window.location.href",\n            "contextId": ctx_id,\n            "returnByValue": True\n        })\n        \n        if \'result\' in result and \'result\' in result[\'result\']:\n            url = result[\'result\'][\'result\'][\'value\']\n            print(f"    \u4e0a\u4e0b\u6587 {ctx_id}: {url[:80]}")\n    \n    runtime.close()\n\n\n# ========================================\n# \u793a\u4f8b 5: \u9ad8\u7ea7 JavaScript \u64cd\u4f5c\n# ========================================\ndef example_advanced_operations():\n    """\n    \u6f14\u793a\u9ad8\u7ea7\u64cd\u4f5c:\n    1. Runtime.compileScript - \u7f16\u8bd1\u811a\u672c\n    2. Runtime.runScript - \u8fd0\u884c\u811a\u672c\n    3. Runtime.globalLexicalScopeNames - \u5168\u5c40\u8bcd\u6cd5\u4f5c\u7528\u57df\n    4. \u6027\u80fd\u6d4b\u91cf\n    """\n    print("\\n" + "="*60)\n    print("\u793a\u4f8b 5: \u9ad8\u7ea7 JavaScript \u64cd\u4f5c")\n    print("="*60)\n    \n    runtime = CDPRuntime(get_websocket_url())\n    runtime.send_command("Runtime.enable")\n    runtime.send_command("Page.enable")\n    runtime.send_command("Page.navigate", {"url": "https://example.com"})\n    time.sleep(2)\n    \n    # 1. \u7f16\u8bd1\u811a\u672c\n    print("\\n--- \u7f16\u8bd1 JavaScript \u811a\u672c ---")\n    script_source = """\n        function fibonacci(n) {\n            if (n <= 1) return n;\n            return fibonacci(n - 1) + fibonacci(n - 2);\n        }\n        \n        fibonacci(10);\n    """\n    \n    compile_result = runtime.send_command("Runtime.compileScript", {\n        "expression": script_source,\n        "sourceURL": "fibonacci.js",\n        "persistScript": True\n    })\n    \n    script_id = None\n    if \'result\' in compile_result and \'scriptId\' in compile_result[\'result\']:\n        script_id = compile_result[\'result\'][\'scriptId\']\n        print(f"    \u7f16\u8bd1\u6210\u529f\uff0c\u811a\u672c ID: {script_id}")\n    \n    # 2. \u8fd0\u884c\u7f16\u8bd1\u7684\u811a\u672c\n    if script_id:\n        print("\\n--- \u8fd0\u884c\u7f16\u8bd1\u7684\u811a\u672c ---")\n        run_result = runtime.send_command("Runtime.runScript", {\n            "scriptId": script_id,\n            "returnByValue": True\n        })\n        \n        if \'result\' in run_result and \'result\' in run_result[\'result\']:\n            result_value = run_result[\'result\'][\'result\'][\'value\']\n            print(f"    \u6267\u884c\u7ed3\u679c: fibonacci(10) = {result_value}")\n    \n    # 3. \u83b7\u53d6\u5168\u5c40\u8bcd\u6cd5\u4f5c\u7528\u57df\u540d\u79f0\n    print("\\n--- \u83b7\u53d6\u5168\u5c40\u8bcd\u6cd5\u4f5c\u7528\u57df ---")\n    scope_result = runtime.send_command("Runtime.globalLexicalScopeNames")\n    \n    if \'result\' in scope_result and \'names\' in scope_result[\'result\']:\n        names = scope_result[\'result\'][\'names\']\n        print(f"    \u5168\u5c40\u53d8\u91cf\u6570\u91cf: {len(names)}")\n        if names:\n            print(f"    \u524d10\u4e2a: {names[:10]}")\n    \n    # 4. \u6027\u80fd\u6d4b\u91cf\n    print("\\n--- \u6027\u80fd\u6d4b\u91cf\u793a\u4f8b ---")\n    \n    # \u6d4b\u8bd5 eval \u6027\u80fd\n    start_time = time.time()\n    runtime.send_command("Runtime.evaluate", {\n        "expression": "Array.from({length: 1000}, (_, i) => i).reduce((a, b) => a + b, 0)",\n        "returnByValue": True\n    })\n    eval_time = time.time() - start_time\n    print(f"    Runtime.evaluate \u8017\u65f6: {eval_time:.3f}\u79d2")\n    \n    # 5. \u6267\u884c\u590d\u6742\u64cd\u4f5c\n    print("\\n--- \u6267\u884c\u590d\u6742 DOM \u64cd\u4f5c ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            (function() {\n                const stats = {\n                    totalElements: document.getElementsByTagName(\'*\').length,\n                    textNodes: 0,\n                    maxDepth: 0\n                };\n                \n                function getDepth(element, depth = 0) {\n                    stats.maxDepth = Math.max(stats.maxDepth, depth);\n                    for (let child of element.children) {\n                        getDepth(child, depth + 1);\n                    }\n                }\n                \n                getDepth(document.body);\n                \n                // \u7edf\u8ba1\u6587\u672c\u8282\u70b9\n                const walker = document.createTreeWalker(\n                    document.body,\n                    NodeFilter.SHOW_TEXT\n                );\n                \n                while (walker.nextNode()) {\n                    if (walker.currentNode.textContent.trim()) {\n                        stats.textNodes++;\n                    }\n                }\n                \n                return stats;\n            })()\n        """,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        stats = result[\'result\'][\'result\'][\'value\']\n        print(f"    DOM \u7edf\u8ba1: {json.dumps(stats, indent=8)}")\n    \n    runtime.close()\n\n\n# ========================================\n# \u793a\u4f8b 6: \u5f02\u6b65\u64cd\u4f5c\u548c Promise\n# ========================================\ndef example_async_operations():\n    """\n    \u6f14\u793a\u5f02\u6b65\u64cd\u4f5c:\n    1. awaitPromise - \u7b49\u5f85 Promise\n    2. Promise \u94fe\u5f0f\u8c03\u7528\n    3. async/await \u8bed\u6cd5\n    4. \u8d85\u65f6\u5904\u7406\n    """\n    print("\\n" + "="*60)\n    print("\u793a\u4f8b 6: \u5f02\u6b65\u64cd\u4f5c\u548c Promise")\n    print("="*60)\n    \n    runtime = CDPRuntime(get_websocket_url())\n    runtime.send_command("Runtime.enable")\n    runtime.send_command("Page.enable")\n    runtime.send_command("Page.navigate", {"url": "https://httpbin.org/delay/1"})\n    time.sleep(3)\n    \n    # 1. \u57fa\u7840 Promise\n    print("\\n--- \u57fa\u7840 Promise ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            new Promise((resolve) => {\n                setTimeout(() => resolve(\'\u5ef6\u8fdf500ms\'), 500);\n            })\n        """,\n        "awaitPromise": True,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        print(f"    \u7ed3\u679c: {result[\'result\'][\'result\'][\'value\']}")\n    \n    # 2. Promise \u94fe\u5f0f\u8c03\u7528\n    print("\\n--- Promise \u94fe\u5f0f\u8c03\u7528 ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            Promise.resolve(10)\n                .then(x => x * 2)\n                .then(x => x + 5)\n                .then(x => `\u6700\u7ec8\u7ed3\u679c: ${x}`)\n        """,\n        "awaitPromise": True,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        print(f"    {result[\'result\'][\'result\'][\'value\']}")\n    \n    # 3. async/await \u8bed\u6cd5\n    print("\\n--- async/await \u8bed\u6cd5 ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            (async function() {\n                await new Promise(r => setTimeout(r, 500));\n                const data = {\n                    timestamp: Date.now(),\n                    message: \'Async \u64cd\u4f5c\u5b8c\u6210\'\n                };\n                return data;\n            })()\n        """,\n        "awaitPromise": True,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        data = result[\'result\'][\'result\'][\'value\']\n        print(f"    \u7ed3\u679c: {json.dumps(data, indent=8)}")\n    \n    # 4. Fetch API (\u5982\u679c\u9875\u9762\u652f\u6301)\n    print("\\n--- Fetch API \u793a\u4f8b ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            fetch(\'https://httpbin.org/json\')\n                .then(response => response.json())\n                .then(data => ({\n                    hasData: data !== null,\n                    keys: Object.keys(data).slice(0, 5)\n                }))\n                .catch(error => ({\n                    error: error.message\n                }))\n        """,\n        "awaitPromise": True,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        data = result[\'result\'][\'result\'][\'value\']\n        print(f"    Fetch \u7ed3\u679c: {json.dumps(data, indent=8, ensure_ascii=False)}")\n    \n    # 5. Promise.all \u5e76\u884c\n    print("\\n--- Promise.all \u5e76\u884c\u64cd\u4f5c ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            Promise.all([\n                new Promise(r => setTimeout(() => r(\'\u4efb\u52a11\'), 300)),\n                new Promise(r => setTimeout(() => r(\'\u4efb\u52a12\'), 200)),\n                new Promise(r => setTimeout(() => r(\'\u4efb\u52a13\'), 100))\n            ]).then(results => ({\n                completed: results.length,\n                results: results\n            }))\n        """,\n        "awaitPromise": True,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        data = result[\'result\'][\'result\'][\'value\']\n        print(f"    \u5e76\u884c\u7ed3\u679c: {json.dumps(data, indent=8, ensure_ascii=False)}")\n    \n    # 6. \u6355\u83b7 Promise \u62d2\u7edd\n    print("\\n--- \u6355\u83b7 Promise \u62d2\u7edd ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            new Promise((resolve, reject) => {\n                setTimeout(() => reject(new Error(\'\u6545\u610f\u62d2\u7edd\')), 100);\n            }).catch(error => ({\n                caught: true,\n                message: error.message\n            }))\n        """,\n        "awaitPromise": True,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        data = result[\'result\'][\'result\'][\'value\']\n        print(f"    \u6355\u83b7\u7ed3\u679c: {json.dumps(data, indent=8, ensure_ascii=False)}")\n    \n    runtime.close()\n\n\n# ========================================\n# \u793a\u4f8b 7: \u7efc\u5408\u5e94\u7528 - JavaScript \u8c03\u8bd5\u5de5\u5177\n# ========================================\ndef example_debug_tool():\n    """\n    \u7efc\u5408\u793a\u4f8b: \u5b9e\u73b0 JavaScript \u8c03\u8bd5\u5de5\u5177\n    1. \u5b9e\u65f6\u6267\u884c\u4ee3\u7801\n    2. \u76d1\u63a7\u5f02\u5e38\n    3. \u67e5\u770b\u5bf9\u8c61\n    4. \u6027\u80fd\u5206\u6790\n    """\n    print("\\n" + "="*60)\n    print("\u793a\u4f8b 7: JavaScript \u8c03\u8bd5\u5de5\u5177")\n    print("="*60)\n    \n    runtime = CDPRuntime(get_websocket_url())\n    \n    # \u8c03\u8bd5\u5de5\u5177\u72b6\u6001\n    debug_state = {\n        "console_logs": [],\n        "exceptions": [],\n        "execution_count": 0,\n        "object_cache": {}\n    }\n    \n    def handle_console(event):\n        params = event[\'params\']\n        msg_type = params.get(\'type\', \'log\')\n        args = params.get(\'args\', [])\n        \n        message_parts = []\n        for arg in args:\n            if \'value\' in arg:\n                message_parts.append(str(arg[\'value\']))\n            elif \'description\' in arg:\n                message_parts.append(arg[\'description\'])\n        \n        message = \' \'.join(message_parts)\n        debug_state["console_logs"].append({\n            \'type\': msg_type,\n            \'message\': message\n        })\n        \n        print(f"\\n[CONSOLE] {msg_type.upper()}: {message}")\n    \n    def handle_exception(event):\n        exception = event[\'params\'][\'exceptionDetails\']\n        text = exception.get(\'text\', \'Unknown error\')\n        \n        debug_state["exceptions"].append({\n            \'text\': text,\n            \'line\': exception.get(\'lineNumber\'),\n            \'column\': exception.get(\'columnNumber\')\n        })\n        \n        print(f"\\n[EXCEPTION] {text}")\n        if exception.get(\'lineNumber\'):\n            print(f"    \u4f4d\u7f6e: \u884c {exception[\'lineNumber\']}, \u5217 {exception.get(\'columnNumber\', 0)}")\n    \n    runtime.on_event("Runtime.consoleAPICalled", handle_console)\n    runtime.on_event("Runtime.exceptionThrown", handle_exception)\n    \n    # \u542f\u52a8\u8c03\u8bd5\u73af\u5883\n    print("\\n--- \u521d\u59cb\u5316\u8c03\u8bd5\u73af\u5883 ---")\n    runtime.send_command("Runtime.enable")\n    runtime.send_command("Page.enable")\n    runtime.send_command("Page.navigate", {"url": "https://example.com"})\n    time.sleep(2)\n    \n    # 1. \u521b\u5efa\u8c03\u8bd5\u8f85\u52a9\u51fd\u6570\n    print("\\n--- \u6ce8\u5165\u8c03\u8bd5\u8f85\u52a9\u51fd\u6570 ---")\n    runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            window.__debug__ = {\n                inspect: function(obj) {\n                    console.log(\'=== Object Inspection ===\');\n                    console.log(\'Type:\', typeof obj);\n                    console.log(\'Constructor:\', obj?.constructor?.name);\n                    if (typeof obj === \'object\' && obj !== null) {\n                        console.log(\'Keys:\', Object.keys(obj));\n                    }\n                    return obj;\n                },\n                \n                measure: function(fn, label = \'Operation\') {\n                    const start = performance.now();\n                    const result = fn();\n                    const duration = performance.now() - start;\n                    console.log(`${label} took ${duration.toFixed(2)}ms`);\n                    return result;\n                },\n                \n                memory: function() {\n                    if (performance.memory) {\n                        return {\n                            used: (performance.memory.usedJSHeapSize / 1048576).toFixed(2) + \' MB\',\n                            total: (performance.memory.totalJSHeapSize / 1048576).toFixed(2) + \' MB\',\n                            limit: (performance.memory.jsHeapSizeLimit / 1048576).toFixed(2) + \' MB\'\n                        };\n                    }\n                    return null;\n                }\n            };\n            \n            console.log(\'Debug utilities loaded\');\n        """\n    })\n    \n    time.sleep(1)\n    \n    # 2. \u6267\u884c\u8c03\u8bd5\u547d\u4ee4\n    print("\\n--- \u6267\u884c\u8c03\u8bd5\u547d\u4ee4 ---")\n    \n    # \u68c0\u67e5\u5185\u5b58\n    print("\\n  > \u68c0\u67e5\u5185\u5b58\u4f7f\u7528")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": "__debug__.memory()",\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        memory = result[\'result\'][\'result\'][\'value\']\n        if memory:\n            print(f"    \u5185\u5b58\u4f7f\u7528: {json.dumps(memory, indent=8)}")\n    \n    # \u68c0\u67e5\u5bf9\u8c61\n    print("\\n  > \u68c0\u67e5 document \u5bf9\u8c61")\n    runtime.send_command("Runtime.evaluate", {\n        "expression": "__debug__.inspect(document)"\n    })\n    time.sleep(1)\n    \n    # \u6027\u80fd\u6d4b\u91cf\n    print("\\n  > \u6027\u80fd\u6d4b\u91cf")\n    runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            __debug__.measure(() => {\n                let sum = 0;\n                for (let i = 0; i < 1000000; i++) {\n                    sum += i;\n                }\n                return sum;\n            }, \'Sum calculation\')\n        """\n    })\n    time.sleep(1)\n    \n    # 3. \u67e5\u8be2\u9875\u9762\u4fe1\u606f\n    print("\\n--- \u67e5\u8be2\u9875\u9762\u4fe1\u606f ---")\n    queries = [\n        ("\u6807\u9898", "document.title"),\n        ("URL", "window.location.href"),\n        ("\u5143\u7d20\u6570\u91cf", "document.getElementsByTagName(\'*\').length"),\n        ("Cookie \u6570\u91cf", "document.cookie.split(\';\').length"),\n        ("\u89c6\u53e3\u5bbd\u5ea6", "window.innerWidth"),\n        ("\u89c6\u53e3\u9ad8\u5ea6", "window.innerHeight")\n    ]\n    \n    print("\\n  \u9875\u9762\u4fe1\u606f:")\n    for label, expression in queries:\n        result = runtime.send_command("Runtime.evaluate", {\n            "expression": expression,\n            "returnByValue": True\n        })\n        \n        if \'result\' in result and \'result\' in result[\'result\']:\n            value = result[\'result\'][\'result\'][\'value\']\n            if isinstance(value, str) and len(value) > 80:\n                value = value[:80] + "..."\n            print(f"    {label}: {value}")\n        \n        debug_state["execution_count"] += 1\n    \n    # 4. \u6d4b\u8bd5\u5f02\u5e38\u5904\u7406\n    print("\\n--- \u6d4b\u8bd5\u5f02\u5e38\u5904\u7406 ---")\n    runtime.send_command("Runtime.evaluate", {\n        "expression": "throw new Error(\'\u6d4b\u8bd5\u5f02\u5e38\u6355\u83b7\')"\n    })\n    time.sleep(1)\n    \n    # 5. \u6267\u884c\u590d\u6742\u5206\u6790\n    print("\\n--- \u6267\u884c\u9875\u9762\u5206\u6790 ---")\n    result = runtime.send_command("Runtime.evaluate", {\n        "expression": """\n            (function analyzeDOM() {\n                const analysis = {\n                    structure: {\n                        depth: 0,\n                        totalNodes: 0,\n                        elementTypes: {}\n                    },\n                    content: {\n                        totalText: 0,\n                        links: 0,\n                        images: 0,\n                        forms: 0\n                    },\n                    scripts: {\n                        inline: document.querySelectorAll(\'script:not([src])\').length,\n                        external: document.querySelectorAll(\'script[src]\').length\n                    },\n                    styles: {\n                        inline: document.querySelectorAll(\'style\').length,\n                        external: document.querySelectorAll(\'link[rel="stylesheet"]\').length\n                    }\n                };\n                \n                // \u5206\u6790\u6df1\u5ea6\n                function getDepth(element, depth = 0) {\n                    analysis.structure.depth = Math.max(analysis.structure.depth, depth);\n                    analysis.structure.totalNodes++;\n                    \n                    const tag = element.tagName?.toLowerCase();\n                    if (tag) {\n                        analysis.structure.elementTypes[tag] = \n                            (analysis.structure.elementTypes[tag] || 0) + 1;\n                    }\n                    \n                    for (let child of element.children) {\n                        getDepth(child, depth + 1);\n                    }\n                }\n                \n                if (document.body) {\n                    getDepth(document.body);\n                }\n                \n                // \u5185\u5bb9\u7edf\u8ba1\n                analysis.content.links = document.getElementsByTagName(\'a\').length;\n                analysis.content.images = document.getElementsByTagName(\'img\').length;\n                analysis.content.forms = document.getElementsByTagName(\'form\').length;\n                \n                // \u6587\u672c\u7edf\u8ba1\n                const walker = document.createTreeWalker(\n                    document.body || document,\n                    NodeFilter.SHOW_TEXT\n                );\n                \n                while (walker.nextNode()) {\n                    const text = walker.currentNode.textContent.trim();\n                    if (text) {\n                        analysis.content.totalText += text.length;\n                    }\n                }\n                \n                return analysis;\n            })()\n        """,\n        "returnByValue": True\n    })\n    \n    if \'result\' in result and \'result\' in result[\'result\']:\n        analysis = result[\'result\'][\'result\'][\'value\']\n        print(f"\\n  DOM \u5206\u6790\u7ed3\u679c:")\n        print(f"    \u7ed3\u6784:")\n        print(f"      \u6700\u5927\u6df1\u5ea6: {analysis[\'structure\'][\'depth\']}")\n        print(f"      \u603b\u8282\u70b9\u6570: {analysis[\'structure\'][\'totalNodes\']}")\n        print(f"      \u5143\u7d20\u7c7b\u578b: {len(analysis[\'structure\'][\'elementTypes\'])} \u79cd")\n        \n        print(f"\\n    \u5185\u5bb9:")\n        print(f"      \u6587\u672c\u957f\u5ea6: {analysis[\'content\'][\'totalText\']} \u5b57\u7b26")\n        print(f"      \u94fe\u63a5: {analysis[\'content\'][\'links\']}")\n        print(f"      \u56fe\u7247: {analysis[\'content\'][\'images\']}")\n        print(f"      \u8868\u5355: {analysis[\'content\'][\'forms\']}")\n        \n        print(f"\\n    \u811a\u672c:")\n        print(f"      \u5185\u8054: {analysis[\'scripts\'][\'inline\']}")\n        print(f"      \u5916\u90e8: {analysis[\'scripts\'][\'external\']}")\n        \n        print(f"\\n    \u6837\u5f0f:")\n        print(f"      \u5185\u8054: {analysis[\'styles\'][\'inline\']}")\n        print(f"      \u5916\u90e8: {analysis[\'styles\'][\'external\']}")\n    \n    # 6. \u663e\u793a\u8c03\u8bd5\u7edf\u8ba1\n    print("\\n" + "="*60)\n    print("\ud83d\udcca \u8c03\u8bd5\u4f1a\u8bdd\u7edf\u8ba1:")\n    print(f"    \u6267\u884c\u6b21\u6570: {debug_state[\'execution_count\']}")\n    print(f"    \u63a7\u5236\u53f0\u65e5\u5fd7: {len(debug_state[\'console_logs\'])}")\n    print(f"    \u6355\u83b7\u5f02\u5e38: {len(debug_state[\'exceptions\'])}")\n    \n    if debug_state[\'console_logs\']:\n        print(f"\\n  \u63a7\u5236\u53f0\u65e5\u5fd7\u7c7b\u578b:")\n        log_types = {}\n        for log in debug_state[\'console_logs\']:\n            t = log[\'type\']\n            log_types[t] = log_types.get(t, 0) + 1\n        for t, count in log_types.items():\n            print(f"      {t}: {count}")\n    \n    if debug_state[\'exceptions\']:\n        print(f"\\n  \u5f02\u5e38\u5217\u8868:")\n        for i, exc in enumerate(debug_state[\'exceptions\'], 1):\n            print(f"      {i}. {exc[\'text\']}")\n    \n    print("="*60)\n    \n    runtime.close()\n\n\n# ========================================\n# \u4e3b\u51fd\u6570\n# ========================================\nif __name__ == "__main__":\n    print("\\n" + "="*60)\n    print("CDP Runtime \u57df\u5b8c\u6574\u793a\u4f8b\u96c6")\n    print("="*60)\n    print("\\n\u8bf7\u786e\u4fdd Chrome \u5df2\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8:")\n    print("chrome --remote-debugging-port=9222 --user-data-dir=/tmp/chrome-debug")\n    print("\\n\u9009\u62e9\u8981\u8fd0\u884c\u7684\u793a\u4f8b:")\n    print("1. \u57fa\u7840 JavaScript \u6267\u884c")\n    print("2. \u5bf9\u8c61\u5c5e\u6027\u68c0\u67e5")\n    print("3. \u63a7\u5236\u53f0\u6d88\u606f\u5904\u7406")\n    print("4. \u6267\u884c\u4e0a\u4e0b\u6587\u7ba1\u7406")\n    print("5. \u9ad8\u7ea7 JavaScript \u64cd\u4f5c")\n    print("6. \u5f02\u6b65\u64cd\u4f5c\u548c Promise")\n    print("7. JavaScript \u8c03\u8bd5\u5de5\u5177\uff08\u7efc\u5408\uff09")\n    print("0. \u8fd0\u884c\u6240\u6709\u793a\u4f8b")\n    \n    try:\n        choice = input("\\n\u8bf7\u8f93\u5165\u9009\u62e9 (0-7): ").strip()\n        \n        examples = {\n            "1": example_basic_evaluation,\n            "2": example_object_inspection,\n            "3": example_console_handling,\n            "4": example_execution_contexts,\n            "5": example_advanced_operations,\n            "6": example_async_operations,\n            "7": example_debug_tool\n        }\n        \n        if choice == "0":\n            for name, example in examples.items():\n                print(f"\\n{\'=\'*60}")\n                print(f"\u8fd0\u884c\u793a\u4f8b {name}...")\n                print(f"{\'=\'*60}")\n                example()\n                time.sleep(3)\n        elif choice in examples:\n            examples[choice]()\n        else:\n            print("\u65e0\u6548\u9009\u62e9")\n        \n        print("\\n\u2705 \u793a\u4f8b\u6267\u884c\u5b8c\u6210\uff01")\n        \n    except requests.exceptions.ConnectionError:\n        print("\\n\u274c \u9519\u8bef: \u65e0\u6cd5\u8fde\u63a5\u5230 Chrome")\n        print("\u8bf7\u786e\u4fdd Chrome \u5df2\u4f7f\u7528 --remote-debugging-port=9222 \u542f\u52a8")\n    except KeyboardInterrupt:\n        print("\\n\\n\u26a0\ufe0f \u7528\u6237\u4e2d\u65ad")\n    except Exception as e:\n        print(f"\\n\u274c \u53d1\u751f\u9519\u8bef: {e}")\n        import traceback\n        traceback.print_exc()\n'})})]})}function p(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(m,{...n})}):m(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>o});var r=t(6540);const s={},i=r.createContext(s);function a(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);