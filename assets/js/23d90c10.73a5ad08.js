"use strict";(globalThis.webpackChunkmy_tutorial_site=globalThis.webpackChunkmy_tutorial_site||[]).push([[4107],{6555:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>h,contentTitle:()=>t,default:()=>o,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"\u5176\u4ed6/playwright/intro6","title":"\ud83d\udc9csync_playwright","description":"sync_playwright \u662f Playwright","source":"@site/docs/\u5176\u4ed6/playwright/6.sync_playwright.md","sourceDirName":"\u5176\u4ed6/playwright","slug":"/\u5176\u4ed6/playwright/intro6","permalink":"/saodoc2/docs/\u5176\u4ed6/playwright/intro6","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"id":"intro6","permalink":"/pw/intro6","title":"\ud83d\udc9csync_playwright"},"sidebar":"otherSidebar","previous":{"title":"\ud83d\udc9cDP\u548cpw\u6df7\u5408\u7f16\u7a0b","permalink":"/saodoc2/docs/\u5176\u4ed6/playwright/intro5"},"next":{"title":"\ud83d\udc9cpage.route()","permalink":"/saodoc2/docs/\u5176\u4ed6/playwright/intro7"}}');var s=l(4848),i=l(8453);const a={id:"intro6",permalink:"/pw/intro6",title:"\ud83d\udc9csync_playwright"},t="Python \u4e2d sync_playwright \u4f7f\u7528\u8be6\u89e3",h={},c=[{value:"1. \u5b89\u88c5 Playwright",id:"1-\u5b89\u88c5-playwright",level:2},{value:"2. \u5f15\u5165 <code>sync_playwright</code>",id:"2-\u5f15\u5165-sync_playwright",level:2},{value:"3. \u57fa\u672c\u4f7f\u7528",id:"3-\u57fa\u672c\u4f7f\u7528",level:2},{value:"4. \u6d4f\u89c8\u5668\u64cd\u4f5c",id:"4-\u6d4f\u89c8\u5668\u64cd\u4f5c",level:2},{value:"4.1 \u542f\u52a8\u6d4f\u89c8\u5668",id:"41-\u542f\u52a8\u6d4f\u89c8\u5668",level:3},{value:"4.2 \u65b0\u5efa\u9875\u9762",id:"42-\u65b0\u5efa\u9875\u9762",level:3},{value:"5. \u9875\u9762\u5e38\u7528\u64cd\u4f5c",id:"5-\u9875\u9762\u5e38\u7528\u64cd\u4f5c",level:2},{value:"5.1 \u6253\u5f00\u9875\u9762",id:"51-\u6253\u5f00\u9875\u9762",level:3},{value:"5.2 \u8f93\u5165\u5185\u5bb9",id:"52-\u8f93\u5165\u5185\u5bb9",level:3},{value:"5.3 \u70b9\u51fb\u6309\u94ae",id:"53-\u70b9\u51fb\u6309\u94ae",level:3},{value:"5.4 \u83b7\u53d6\u5143\u7d20\u6587\u672c",id:"54-\u83b7\u53d6\u5143\u7d20\u6587\u672c",level:3},{value:"5.5 \u83b7\u53d6\u5c5e\u6027",id:"55-\u83b7\u53d6\u5c5e\u6027",level:3},{value:"5.6 \u7b49\u5f85\u5143\u7d20\u52a0\u8f7d",id:"56-\u7b49\u5f85\u5143\u7d20\u52a0\u8f7d",level:3},{value:"6. \u9875\u9762\u622a\u56fe\u4e0e PDF",id:"6-\u9875\u9762\u622a\u56fe\u4e0e-pdf",level:2},{value:"7. \u6267\u884c JavaScript",id:"7-\u6267\u884c-javascript",level:2},{value:"8. \u5904\u7406\u5f39\u7a97 (Dialog)",id:"8-\u5904\u7406\u5f39\u7a97-dialog",level:2},{value:"9. \u7f51\u7edc\u8bf7\u6c42\u62e6\u622a\u4e0e\u4fee\u6539",id:"9-\u7f51\u7edc\u8bf7\u6c42\u62e6\u622a\u4e0e\u4fee\u6539",level:2},{value:"10. \u6587\u4ef6\u4e0a\u4f20\u4e0e\u4e0b\u8f7d",id:"10-\u6587\u4ef6\u4e0a\u4f20\u4e0e\u4e0b\u8f7d",level:2},{value:"\u4e0a\u4f20\u6587\u4ef6",id:"\u4e0a\u4f20\u6587\u4ef6",level:3},{value:"\u6587\u4ef6\u4e0b\u8f7d",id:"\u6587\u4ef6\u4e0b\u8f7d",level:3},{value:"11. \u81ea\u52a8\u7b49\u5f85\u673a\u5236",id:"11-\u81ea\u52a8\u7b49\u5f85\u673a\u5236",level:2},{value:"12. \u793a\u4f8b\uff1a\u767e\u5ea6\u641c\u7d22\u5e76\u622a\u56fe",id:"12-\u793a\u4f8b\u767e\u5ea6\u641c\u7d22\u5e76\u622a\u56fe",level:2},{value:"13. \u603b\u7ed3",id:"13-\u603b\u7ed3",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsxs)(n.h1,{id:"python-\u4e2d-sync_playwright-\u4f7f\u7528\u8be6\u89e3",children:["Python \u4e2d ",(0,s.jsx)(n.code,{children:"sync_playwright"})," \u4f7f\u7528\u8be6\u89e3"]})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"sync_playwright"})," \u662f ",(0,s.jsx)(n.a,{href:"https://playwright.dev/python/",children:"Playwright"}),"\n\u63d0\u4f9b\u7684\u540c\u6b65 API \u63a5\u53e3\uff0c",(0,s.jsx)(n.br,{}),"\n","\u5b83\u5141\u8bb8\u6211\u4eec\u4ee5\u540c\u6b65\u7684\u65b9\u5f0f\u7f16\u5199\u6d4f\u89c8\u5668\u81ea\u52a8\u5316\u811a\u672c\uff0c\u800c\u4e0d\u7528\u5904\u7406\u5f02\u6b65 ",(0,s.jsx)(n.code,{children:"async/await"}),"\n\u8bed\u6cd5\uff0c",(0,s.jsx)(n.br,{}),"\n","\u975e\u5e38\u9002\u5408\u5feb\u901f\u4e0a\u624b\u548c\u7f16\u5199\u811a\u672c\u3002"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"1-\u5b89\u88c5-playwright",children:"1. \u5b89\u88c5 Playwright"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install playwright\n# \u5b89\u88c5\u6d4f\u89c8\u5668\u9a71\u52a8\nplaywright install\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.h2,{id:"2-\u5f15\u5165-sync_playwright",children:["2. \u5f15\u5165 ",(0,s.jsx)(n.code,{children:"sync_playwright"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"from playwright.sync_api import sync_playwright\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"sync_playwright"})," \u662f Playwright \u7684\u5165\u53e3\uff0c",(0,s.jsx)(n.br,{}),"\n","\u9700\u8981\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"with"})," \u4e0a\u4e0b\u6587\u6765\u542f\u52a8\u548c\u5173\u95ed Playwright\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-\u57fa\u672c\u4f7f\u7528",children:"3. \u57fa\u672c\u4f7f\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from playwright.sync_api import sync_playwright\n\nwith sync_playwright() as p:\n    # \u542f\u52a8\u6d4f\u89c8\u5668 (chromium / firefox / webkit)\n    browser = p.chromium.launch(headless=False)  \n    page = browser.new_page()\n    \n    # \u6253\u5f00\u7f51\u9875\n    page.goto("https://example.com")\n    \n    # \u83b7\u53d6\u9875\u9762\u6807\u9898\n    print(page.title())\n    \n    # \u622a\u56fe\n    page.screenshot(path="example.png")\n    \n    # \u5173\u95ed\u6d4f\u89c8\u5668\n    browser.close()\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"4-\u6d4f\u89c8\u5668\u64cd\u4f5c",children:"4. \u6d4f\u89c8\u5668\u64cd\u4f5c"}),"\n",(0,s.jsx)(n.h3,{id:"41-\u542f\u52a8\u6d4f\u89c8\u5668",children:"4.1 \u542f\u52a8\u6d4f\u89c8\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# \u65e0\u5934\u6a21\u5f0f (\u9ed8\u8ba4 True)\nbrowser = p.chromium.launch(headless=True)\n\n# \u663e\u793a\u6d4f\u89c8\u5668\u7a97\u53e3\nbrowser = p.chromium.launch(headless=False)\n\n# \u8c03\u8bd5\u6a21\u5f0f (slow_mo \u6bcf\u6b65\u64cd\u4f5c\u5ef6\u8fdf 500ms)\nbrowser = p.chromium.launch(headless=False, slow_mo=500)\n\n# \u6307\u5b9a\u7528\u6237\u6570\u636e\u76ee\u5f55\uff08\u4fdd\u5b58\u767b\u5f55\u72b6\u6001\u7b49\uff09\nbrowser = p.chromium.launch_persistent_context(\n    user_data_dir="userdata",\n    headless=False\n)\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"42-\u65b0\u5efa\u9875\u9762",children:"4.2 \u65b0\u5efa\u9875\u9762"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"context = browser.new_context()\npage = context.new_page()\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4e00\u4e2a ",(0,s.jsx)(n.strong,{children:"Browser"})," \u53ef\u4ee5\u5305\u542b\u591a\u4e2a ",(0,s.jsx)(n.strong,{children:"Context"}),"\uff0c\u6bcf\u4e2a ",(0,s.jsx)(n.strong,{children:"Context"}),"\n\u5c31\u50cf\u4e00\u4e2a\u72ec\u7acb\u7684\u6d4f\u89c8\u5668\u5b9e\u4f8b\uff0c\u4e92\u4e0d\u5e72\u6270\u3002"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"5-\u9875\u9762\u5e38\u7528\u64cd\u4f5c",children:"5. \u9875\u9762\u5e38\u7528\u64cd\u4f5c"}),"\n",(0,s.jsx)(n.h3,{id:"51-\u6253\u5f00\u9875\u9762",children:"5.1 \u6253\u5f00\u9875\u9762"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'page.goto("https://www.baidu.com")\n'})}),"\n",(0,s.jsx)(n.h3,{id:"52-\u8f93\u5165\u5185\u5bb9",children:"5.2 \u8f93\u5165\u5185\u5bb9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'page.fill("input[name=\'wd\']", "Playwright Python")\n'})}),"\n",(0,s.jsx)(n.h3,{id:"53-\u70b9\u51fb\u6309\u94ae",children:"5.3 \u70b9\u51fb\u6309\u94ae"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"page.click(\"input[type='submit']\")\n"})}),"\n",(0,s.jsx)(n.h3,{id:"54-\u83b7\u53d6\u5143\u7d20\u6587\u672c",children:"5.4 \u83b7\u53d6\u5143\u7d20\u6587\u672c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'text = page.inner_text("h1")\nprint(text)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"55-\u83b7\u53d6\u5c5e\u6027",children:"5.5 \u83b7\u53d6\u5c5e\u6027"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'href = page.get_attribute("a", "href")\nprint(href)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"56-\u7b49\u5f85\u5143\u7d20\u52a0\u8f7d",children:"5.6 \u7b49\u5f85\u5143\u7d20\u52a0\u8f7d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'page.wait_for_selector("#result")\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"6-\u9875\u9762\u622a\u56fe\u4e0e-pdf",children:"6. \u9875\u9762\u622a\u56fe\u4e0e PDF"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# \u622a\u56fe\npage.screenshot(path="page.png", full_page=True)\n\n# \u5bfc\u51fa PDF (\u4ec5\u652f\u6301 Chromium)\npage.pdf(path="page.pdf", format="A4")\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"7-\u6267\u884c-javascript",children:"7. \u6267\u884c JavaScript"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'result = page.evaluate("() => document.title")\nprint(result)\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u4f20\u53c2\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'result = page.evaluate("(x, y) => x + y", 5, 7)\nprint(result)  # 12\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"8-\u5904\u7406\u5f39\u7a97-dialog",children:"8. \u5904\u7406\u5f39\u7a97 (Dialog)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def handle_dialog(dialog):\n    print(dialog.message)\n    dialog.accept()\n\npage.on("dialog", handle_dialog)\npage.click("#alertButton")\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"9-\u7f51\u7edc\u8bf7\u6c42\u62e6\u622a\u4e0e\u4fee\u6539",children:"9. \u7f51\u7edc\u8bf7\u6c42\u62e6\u622a\u4e0e\u4fee\u6539"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def handle_route(route, request):\n    if "api" in request.url:\n        print("\u62e6\u622a\u5230\u8bf7\u6c42:", request.url)\n        route.abort()\n    else:\n        route.continue_()\n\npage.route("**/*", handle_route)\npage.goto("https://example.com")\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"10-\u6587\u4ef6\u4e0a\u4f20\u4e0e\u4e0b\u8f7d",children:"10. \u6587\u4ef6\u4e0a\u4f20\u4e0e\u4e0b\u8f7d"}),"\n",(0,s.jsx)(n.h3,{id:"\u4e0a\u4f20\u6587\u4ef6",children:"\u4e0a\u4f20\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'page.set_input_files("input[type=\'file\']", "example.txt")\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u6587\u4ef6\u4e0b\u8f7d",children:"\u6587\u4ef6\u4e0b\u8f7d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'with page.expect_download() as download_info:\n    page.click("a#download")\ndownload = download_info.value\ndownload.save_as("downloaded_file.txt")\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"11-\u81ea\u52a8\u7b49\u5f85\u673a\u5236",children:"11. \u81ea\u52a8\u7b49\u5f85\u673a\u5236"}),"\n",(0,s.jsxs)(n.p,{children:["Playwright \u5185\u7f6e\u667a\u80fd\u7b49\u5f85\uff0c\u4e0d\u9700\u8981\u9891\u7e41 ",(0,s.jsx)(n.code,{children:"sleep"}),"\u3002",(0,s.jsx)(n.br,{}),"\n","\u5e38\u89c1\u7b49\u5f85\u65b9\u6cd5\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:'page.wait_for_selector("css")'})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"page.wait_for_timeout(2000)"})," # \u5f3a\u5236\u7b49\u5f85 2 \u79d2"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:'page.wait_for_load_state("networkidle")'})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"12-\u793a\u4f8b\u767e\u5ea6\u641c\u7d22\u5e76\u622a\u56fe",children:"12. \u793a\u4f8b\uff1a\u767e\u5ea6\u641c\u7d22\u5e76\u622a\u56fe"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from playwright.sync_api import sync_playwright\n\nwith sync_playwright() as p:\n    browser = p.chromium.launch(headless=False)\n    page = browser.new_page()\n    \n    page.goto("https://www.baidu.com")\n    page.fill("input[name=\'wd\']", "Playwright Python")\n    page.press("input[name=\'wd\']", "Enter")\n    \n    page.wait_for_selector("#content_left")\n    page.screenshot(path="baidu_result.png", full_page=True)\n    \n    browser.close()\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"13-\u603b\u7ed3",children:"13. \u603b\u7ed3"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sync_playwright"})," \u9002\u5408\u5feb\u901f\u7f16\u5199\u540c\u6b65\u811a\u672c\uff0c\u7b80\u5355\u6613\u7528\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684 ",(0,s.jsx)(n.strong,{children:"\u9875\u9762\u64cd\u4f5c\nAPI"}),"\uff0c\u5305\u62ec\u5143\u7d20\u4ea4\u4e92\u3001\u622a\u56fe\u3001PDF\u3001\u4e0b\u8f7d\u3001\u4e0a\u4f20\u7b49\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5185\u7f6e ",(0,s.jsx)(n.strong,{children:"\u667a\u80fd\u7b49\u5f85\u673a\u5236"}),"\uff0c\u5927\u5927\u51cf\u5c11\u624b\u52a8 ",(0,s.jsx)(n.code,{children:"sleep"})," \u7684\u9700\u8981\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u53ef\u7528\u4e8e ",(0,s.jsx)(n.strong,{children:"\u722c\u866b\u3001\u81ea\u52a8\u5316\u6d4b\u8bd5\u3001\u9006\u5411\u5206\u6790"})," \u7b49\u573a\u666f\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udccc ",(0,s.jsx)(n.strong,{children:"\u5b98\u65b9\u6587\u6863"}),": ",(0,s.jsx)(n.a,{href:"https://playwright.dev/python/docs/intro",children:"Playwright for\nPython"})]})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>t});var r=l(6540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);